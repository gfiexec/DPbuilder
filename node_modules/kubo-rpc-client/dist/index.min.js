(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.KuboRpcClient = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var KuboRpcClient=(()=>{var Sf=Object.create;var Jr=Object.defineProperty;var Pf=Object.getOwnPropertyDescriptor;var Af=Object.getOwnPropertyNames;var Cf=Object.getPrototypeOf,vf=Object.prototype.hasOwnProperty;var Be=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),j=(e,r)=>{for(var t in r)Jr(e,t,{get:r[t],enumerable:!0})},os=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of Af(r))!vf.call(e,o)&&o!==t&&Jr(e,o,{get:()=>r[o],enumerable:!(n=Pf(r,o))||n.enumerable});return e};var De=(e,r,t)=>(t=e!=null?Sf(Cf(e)):{},os(r||!e||!e.__esModule?Jr(t,"default",{value:e,enumerable:!0}):t,e)),If=e=>os(Jr({},"__esModule",{value:!0}),e);var Ba=Be((w0,Na)=>{function pm(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}Na.exports=pm});var Lr=Be((P0,Oa)=>{"use strict";function La(e,r){for(let t in r)Object.defineProperty(e,t,{value:r[t],enumerable:!0,configurable:!0});return e}function mm(e,r,t){if(!e||typeof e=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof r=="object"&&(t=r,r=""),r&&(t.code=r);try{return La(e,t)}catch{t.message=e.message,t.stack=e.stack;let o=function(){};return o.prototype=Object.create(Object.getPrototypeOf(e)),La(new o,t)}}Oa.exports=mm});var Mc=Be((_P,zc)=>{"use strict";zc.exports=e=>{if(Object.prototype.toString.call(e)!=="[object Object]")return!1;let r=Object.getPrototypeOf(e);return r===null||r===Object.prototype}});var Jc=Be((Gc,Wc)=>{"use strict";var _t=Mc(),{hasOwnProperty:Hc}=Object.prototype,{propertyIsEnumerable:Zm}=Object,pr=(e,r,t)=>Object.defineProperty(e,r,{value:t,writable:!0,enumerable:!0,configurable:!0}),eh=Gc,Vc={concatArrays:!1,ignoreUndefined:!1},Rt=e=>{let r=[];for(let t in e)Hc.call(e,t)&&r.push(t);if(Object.getOwnPropertySymbols){let t=Object.getOwnPropertySymbols(e);for(let n of t)Zm.call(e,n)&&r.push(n)}return r};function mr(e){return Array.isArray(e)?rh(e):_t(e)?th(e):e}function rh(e){let r=e.slice(0,0);return Rt(e).forEach(t=>{pr(r,t,mr(e[t]))}),r}function th(e){let r=Object.getPrototypeOf(e)===null?Object.create(null):{};return Rt(e).forEach(t=>{pr(r,t,mr(e[t]))}),r}var qc=(e,r,t,n)=>(t.forEach(o=>{typeof r[o]>"u"&&n.ignoreUndefined||(o in e&&e[o]!==Object.getPrototypeOf(e)?pr(e,o,jo(e[o],r[o],n)):pr(e,o,mr(r[o])))}),e),nh=(e,r,t)=>{let n=e.slice(0,0),o=0;return[e,r].forEach(s=>{let i=[];for(let a=0;a<s.length;a++)Hc.call(s,a)&&(i.push(String(a)),s===e?pr(n,o++,s[a]):pr(n,o++,mr(s[a])));n=qc(n,s,Rt(s).filter(a=>!i.includes(a)),t)}),n};function jo(e,r,t){return t.concatArrays&&Array.isArray(e)&&Array.isArray(r)?nh(e,r,t):!_t(r)||!_t(e)?mr(r):qc(e,r,Rt(r),t)}Wc.exports=function(...e){let r=jo(mr(Vc),this!==eh&&this||{},Vc),t={_:{}};for(let n of e)if(n!==void 0){if(!_t(n))throw new TypeError("`"+n+"` is not an Option Object");t=jo(t,{_:n},r)}return t._}});var Mo=Be((OP,eu)=>{"use strict";var sh=typeof navigator<"u"&&navigator.product==="ReactNative";function ih(){return sh?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}var qr=self.URL,Zc=ih(),zo=class{constructor(r="",t=Zc){this.super=new qr(r,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(r){this.super.hash=r}set host(r){this.super.host=r}set hostname(r){this.super.hostname=r}set href(r){this.super.href=r}set password(r){this.super.password=r}set pathname(r){this.super.pathname=r}set port(r){this.super.port=r}set protocol(r){this.super.protocol=r}set search(r){this.super.search=r}set username(r){this.super.username=r}static createObjectURL(r){return qr.createObjectURL(r)}static revokeObjectURL(r){qr.revokeObjectURL(r)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function ah(e){if(typeof e=="string")return new qr(e).toString();if(!(e instanceof qr)){let r=e.username&&e.password?`${e.username}:${e.password}@`:"",t=e.auth?e.auth+"@":"",n=e.port?":"+e.port:"",o=e.protocol?e.protocol+"//":"",s=e.host||"",i=e.hostname||"",a=e.search||(e.query?"?"+e.query:""),f=e.hash||"",h=e.pathname||"",d=e.path||h+a;return`${o}${r||t}${s||i+n}${d}${f}`}}eu.exports={URLWithLegacySupport:zo,URLSearchParams:self.URLSearchParams,defaultBase:Zc,format:ah}});var nu=Be((FP,tu)=>{"use strict";var{URLWithLegacySupport:ru,format:ch}=Mo();tu.exports=(e,r={},t={},n)=>{let o=r.protocol?r.protocol.replace(":",""):"http";o=(t[o]||n||o)+":";let s;try{s=new ru(e)}catch{s={}}let i=Object.assign({},r,{protocol:o||s.protocol,host:r.host||s.host});return new ru(e,ch(i)).toString()}});var su=Be((jP,ou)=>{"use strict";var{URLWithLegacySupport:uh,format:fh,URLSearchParams:dh,defaultBase:lh}=Mo(),ph=nu();ou.exports={URL:uh,URLSearchParams:dh,format:fh,relative:ph,defaultBase:lh}});var Hh={};j(Hh,{CID:()=>m,RoutingEventTypes:()=>Bo,RoutingMessageType:()=>Do,create:()=>Mh,createBitswap:()=>Co,createBlock:()=>vo,createBootstrap:()=>Io,createConfig:()=>Uo,createDAG:()=>No,createDHT:()=>_o,createDiag:()=>Ro,createFiles:()=>Lo,createKey:()=>Oo,createKuboRPCClient:()=>Mh,createLog:()=>Wo,createName:()=>Jo,createObject:()=>Ko,createPin:()=>Xo,createPubsub:()=>Qo,createRefs:()=>Yo,createRepo:()=>Zo,createRouting:()=>es,createStats:()=>rs,createSwarm:()=>ts,multiaddr:()=>k,readURLContent:()=>Ef,urlSource:()=>Vh});var en={};j(en,{base58btc:()=>z,base58flickr:()=>Df});var Gh=new Uint8Array(0);function ss(e,r){if(e===r)return!0;if(e.byteLength!==r.byteLength)return!1;for(let t=0;t<e.byteLength;t++)if(e[t]!==r[t])return!1;return!0}function ae(e){if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function is(e){return new TextEncoder().encode(e)}function as(e){return new TextDecoder().decode(e)}function Uf(e,r){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var o=0;o<e.length;o++){var s=e.charAt(o),i=s.charCodeAt(0);if(t[i]!==255)throw new TypeError(s+" is ambiguous");t[i]=o}var a=e.length,f=e.charAt(0),h=Math.log(a)/Math.log(256),d=Math.log(256)/Math.log(a);function p(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var x=0,C=0,P=0,N=g.length;P!==N&&g[P]===0;)P++,x++;for(var _=(N-P)*d+1>>>0,I=new Uint8Array(_);P!==N;){for(var R=g[P],O=0,B=_-1;(R!==0||O<C)&&B!==-1;B--,O++)R+=256*I[B]>>>0,I[B]=R%a>>>0,R=R/a>>>0;if(R!==0)throw new Error("Non-zero carry");C=O,P++}for(var $=_-C;$!==_&&I[$]===0;)$++;for(var ie=f.repeat(x);$<_;++$)ie+=e.charAt(I[$]);return ie}function b(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var x=0;if(g[x]!==" "){for(var C=0,P=0;g[x]===f;)C++,x++;for(var N=(g.length-x)*h+1>>>0,_=new Uint8Array(N);g[x];){var I=t[g.charCodeAt(x)];if(I===255)return;for(var R=0,O=N-1;(I!==0||R<P)&&O!==-1;O--,R++)I+=a*_[O]>>>0,_[O]=I%256>>>0,I=I/256>>>0;if(I!==0)throw new Error("Non-zero carry");P=R,x++}if(g[x]!==" "){for(var B=N-P;B!==N&&_[B]===0;)B++;for(var $=new Uint8Array(C+(N-B)),ie=C;B!==N;)$[ie++]=_[B++];return $}}}function T(g){var x=b(g);if(x)return x;throw new Error(`Non-${r} character`)}return{encode:p,decodeUnsafe:b,decode:T}}var Tf=Uf,kf=Tf,us=kf;var Xt=class{name;prefix;baseEncode;constructor(r,t,n){this.name=r,this.prefix=t,this.baseEncode=n}encode(r){if(r instanceof Uint8Array)return`${this.prefix}${this.baseEncode(r)}`;throw Error("Unknown type, must be binary type")}},Qt=class{name;prefix;baseDecode;prefixCodePoint;constructor(r,t,n){if(this.name=r,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(r){if(typeof r=="string"){if(r.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(r)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(r.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(r){return fs(this,r)}},Yt=class{decoders;constructor(r){this.decoders=r}or(r){return fs(this,r)}decode(r){let t=r[0],n=this.decoders[t];if(n!=null)return n.decode(r);throw RangeError(`Unable to decode multibase string ${JSON.stringify(r)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function fs(e,r){return new Yt({...e.decoders??{[e.prefix]:e},...r.decoders??{[r.prefix]:r}})}var Zt=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(r,t,n,o){this.name=r,this.prefix=t,this.baseEncode=n,this.baseDecode=o,this.encoder=new Xt(r,t,n),this.decoder=new Qt(r,t,o)}encode(r){return this.encoder.encode(r)}decode(r){return this.decoder.decode(r)}};function ze({name:e,prefix:r,encode:t,decode:n}){return new Zt(e,r,t,n)}function Ae({name:e,prefix:r,alphabet:t}){let{encode:n,decode:o}=us(t,e);return ze({prefix:r,name:e,encode:n,decode:s=>ae(o(s))})}function Nf(e,r,t,n){let o={};for(let d=0;d<r.length;++d)o[r[d]]=d;let s=e.length;for(;e[s-1]==="=";)--s;let i=new Uint8Array(s*t/8|0),a=0,f=0,h=0;for(let d=0;d<s;++d){let p=o[e[d]];if(p===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<t|p,a+=t,a>=8&&(a-=8,i[h++]=255&f>>a)}if(a>=t||255&f<<8-a)throw new SyntaxError("Unexpected end of data");return i}function Bf(e,r,t){let n=r[r.length-1]==="=",o=(1<<t)-1,s="",i=0,a=0;for(let f=0;f<e.length;++f)for(a=a<<8|e[f],i+=8;i>t;)i-=t,s+=r[o&a>>i];if(i!==0&&(s+=r[o&a<<t-i]),n)for(;s.length*t&7;)s+="=";return s}function L({name:e,prefix:r,bitsPerChar:t,alphabet:n}){return ze({prefix:r,name:e,encode(o){return Bf(o,n,t)},decode(o){return Nf(o,n,t,e)}})}var z=Ae({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Df=Ae({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var rn={};j(rn,{base32:()=>ce,base32hex:()=>Lf,base32hexpad:()=>Ff,base32hexpadupper:()=>jf,base32hexupper:()=>Of,base32pad:()=>Rf,base32padupper:()=>$f,base32upper:()=>_f,base32z:()=>zf});var ce=L({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),_f=L({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Rf=L({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),$f=L({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Lf=L({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Of=L({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ff=L({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),jf=L({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),zf=L({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Mf=ps,ds=128,Vf=127,Hf=~Vf,qf=Math.pow(2,31);function ps(e,r,t){r=r||[],t=t||0;for(var n=t;e>=qf;)r[t++]=e&255|ds,e/=128;for(;e&Hf;)r[t++]=e&255|ds,e>>>=7;return r[t]=e|0,ps.bytes=t-n+1,r}var Gf=tn,Wf=128,ls=127;function tn(e,n){var t=0,n=n||0,o=0,s=n,i,a=e.length;do{if(s>=a)throw tn.bytes=0,new RangeError("Could not decode varint");i=e[s++],t+=o<28?(i&ls)<<o:(i&ls)*Math.pow(2,o),o+=7}while(i>=Wf);return tn.bytes=s-n,t}var Jf=Math.pow(2,7),Kf=Math.pow(2,14),Xf=Math.pow(2,21),Qf=Math.pow(2,28),Yf=Math.pow(2,35),Zf=Math.pow(2,42),ed=Math.pow(2,49),rd=Math.pow(2,56),td=Math.pow(2,63),nd=function(e){return e<Jf?1:e<Kf?2:e<Xf?3:e<Qf?4:e<Yf?5:e<Zf?6:e<ed?7:e<rd?8:e<td?9:10},od={encode:Mf,decode:Gf,encodingLength:nd},sd=od,br=sd;function Er(e,r=0){return[br.decode(e,r),br.decode.bytes]}function Me(e,r,t=0){return br.encode(e,r,t),r}function Ve(e){return br.encodingLength(e)}function Ce(e,r){let t=r.byteLength,n=Ve(e),o=n+Ve(t),s=new Uint8Array(o+t);return Me(e,s,0),Me(t,s,n),s.set(r,o),new He(e,t,r,s)}function _e(e){let r=ae(e),[t,n]=Er(r),[o,s]=Er(r.subarray(n)),i=r.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new He(t,o,i,r)}function ms(e,r){if(e===r)return!0;{let t=r;return e.code===t.code&&e.size===t.size&&t.bytes instanceof Uint8Array&&ss(e.bytes,t.bytes)}}var He=class{code;size;digest;bytes;constructor(r,t,n,o){this.code=r,this.size=t,this.digest=n,this.bytes=o}};function hs(e,r){let{bytes:t,version:n}=e;switch(n){case 0:return ad(t,nn(e),r??z.encoder);default:return cd(t,nn(e),r??ce.encoder)}}var ys=new WeakMap;function nn(e){let r=ys.get(e);if(r==null){let t=new Map;return ys.set(e,t),t}return r}var m=class e{code;version;multihash;bytes;"/";constructor(r,t,n,o){this.code=t,this.version=r,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:r,multihash:t}=this;if(r!==Sr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==ud)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return e.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:r,digest:t}=this.multihash,n=Ce(r,t);return e.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(r){return e.equals(this,r)}static equals(r,t){let n=t;return n!=null&&r.code===n.code&&r.version===n.version&&ms(r.multihash,n.multihash)}toString(r){return hs(this,r)}toJSON(){return{"/":hs(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(r){if(r==null)return null;let t=r;if(t instanceof e)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){let{version:n,code:o,multihash:s,bytes:i}=t;return new e(n,o,s,i??gs(n,o,s.bytes))}else if(t[fd]===!0){let{version:n,multihash:o,code:s}=t,i=_e(o);return e.create(n,s,i)}else return null}static create(r,t,n){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(r){case 0:{if(t!==Sr)throw new Error(`Version 0 CID must use dag-pb (code: ${Sr}) block encoding`);return new e(r,t,n,n.bytes)}case 1:{let o=gs(r,t,n.bytes);return new e(r,t,n,o)}default:throw new Error("Invalid version")}}static createV0(r){return e.create(0,Sr,r)}static createV1(r,t){return e.create(1,r,t)}static decode(r){let[t,n]=e.decodeFirst(r);if(n.length!==0)throw new Error("Incorrect length");return t}static decodeFirst(r){let t=e.inspectBytes(r),n=t.size-t.multihashSize,o=ae(r.subarray(n,n+t.multihashSize));if(o.byteLength!==t.multihashSize)throw new Error("Incorrect length");let s=o.subarray(t.multihashSize-t.digestSize),i=new He(t.multihashCode,t.digestSize,s,o);return[t.version===0?e.createV0(i):e.createV1(t.codec,i),r.subarray(t.size)]}static inspectBytes(r){let t=0,n=()=>{let[p,b]=Er(r.subarray(t));return t+=b,p},o=n(),s=Sr;if(o===18?(o=0,t=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=t,a=n(),f=n(),h=t+f,d=h-i;return{version:o,codec:s,multihashCode:a,digestSize:f,multihashSize:d,size:h}}static parse(r,t){let[n,o]=id(r,t),s=e.decode(o);if(s.version===0&&r[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return nn(s).set(n,r),s}};function id(e,r){switch(e[0]){case"Q":{let t=r??z;return[z.prefix,t.decode(`${z.prefix}${e}`)]}case z.prefix:{let t=r??z;return[z.prefix,t.decode(e)]}case ce.prefix:{let t=r??ce;return[ce.prefix,t.decode(e)]}default:{if(r==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],r.decode(e)]}}}function ad(e,r,t){let{prefix:n}=t;if(n!==z.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let o=r.get(n);if(o==null){let s=t.encode(e).slice(1);return r.set(n,s),s}else return o}function cd(e,r,t){let{prefix:n}=t,o=r.get(n);if(o==null){let s=t.encode(e);return r.set(n,s),s}else return o}var Sr=112,ud=18;function gs(e,r,t){let n=Ve(e),o=n+Ve(r),s=new Uint8Array(o+t.byteLength);return Me(e,s,0),Me(r,s,n),s.set(t,o),s}var fd=Symbol.for("@ipld/js-cid/CID");function Pr(e,r){if(e===r)return!0;if(e.byteLength!==r.byteLength)return!1;for(let t=0;t<e.byteLength;t++)if(e[t]!==r[t])return!1;return!0}var on={};j(on,{base10:()=>dd});var dd=Ae({prefix:"9",name:"base10",alphabet:"0123456789"});var sn={};j(sn,{base16:()=>ld,base16upper:()=>pd});var ld=L({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),pd=L({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var an={};j(an,{base2:()=>md});var md=L({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var cn={};j(cn,{base256emoji:()=>xd});var ws=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),hd=ws.reduce((e,r,t)=>(e[t]=r,e),[]),yd=ws.reduce((e,r,t)=>(e[r.codePointAt(0)]=t,e),[]);function gd(e){return e.reduce((r,t)=>(r+=hd[t],r),"")}function wd(e){let r=[];for(let t of e){let n=yd[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);r.push(n)}return new Uint8Array(r)}var xd=ze({prefix:"\u{1F680}",name:"base256emoji",encode:gd,decode:wd});var un={};j(un,{base36:()=>bd,base36upper:()=>Ed});var bd=Ae({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ed=Ae({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var fn={};j(fn,{base64:()=>qe,base64pad:()=>Sd,base64url:()=>Ar,base64urlpad:()=>Pd});var qe=L({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Sd=L({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ar=L({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Pd=L({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var dn={};j(dn,{base8:()=>Ad});var Ad=L({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ln={};j(ln,{identity:()=>Cd});var Cd=ze({prefix:"\0",name:"identity",encode:e=>as(e),decode:e=>is(e)});var pn={};j(pn,{code:()=>Td,decode:()=>Nd,encode:()=>kd,name:()=>Ud});var vd=new TextEncoder,Id=new TextDecoder,Ud="json",Td=512;function kd(e){return vd.encode(JSON.stringify(e))}function Nd(e){return JSON.parse(Id.decode(e))}var mn={};j(mn,{code:()=>Dd,decode:()=>Rd,encode:()=>_d,name:()=>Bd});var Bd="raw",Dd=85;function _d(e){return ae(e)}function Rd(e){return ae(e)}var hn={};j(hn,{identity:()=>ve});var xs=0,$d="identity",bs=ae;function Ld(e){return Ce(xs,bs(e))}var ve={code:xs,name:$d,encode:bs,digest:Ld};var wn={};j(wn,{sha256:()=>Xr,sha512:()=>Od});function gn({name:e,code:r,encode:t}){return new yn(e,r,t)}var yn=class{name;code;encode;constructor(r,t,n){this.name=r,this.code=t,this.encode=n}digest(r){if(r instanceof Uint8Array){let t=this.encode(r);return t instanceof Uint8Array?Ce(this.code,t):t.then(n=>Ce(this.code,n))}else throw Error("Unknown type, must be binary type")}};function Ss(e){return async r=>new Uint8Array(await crypto.subtle.digest(e,r))}var Xr=gn({name:"sha2-256",code:18,encode:Ss("SHA-256")}),Od=gn({name:"sha2-512",code:19,encode:Ss("SHA-512")});var he={...ln,...an,...dn,...on,...sn,...rn,...un,...en,...fn,...cn},Ps={...wn,...hn},As={raw:mn,json:pn};function Ge(e=0){return new Uint8Array(e)}function vs(e,r,t,n){return{name:e,prefix:r,encoder:{name:e,prefix:r,encode:t},decoder:{decode:n}}}var Cs=vs("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),xn=vs("ascii","a",e=>{let r="a";for(let t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return r},e=>{e=e.substring(1);let r=Ge(e.length);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r}),Fd={utf8:Cs,"utf-8":Cs,hex:he.base16,latin1:xn,ascii:xn,binary:xn,...he},Qr=Fd;function D(e,r="utf8"){let t=Qr[r];if(t==null)throw new Error(`Unsupported encoding "${r}"`);return t.encoder.encode(e).substring(1)}var jd=Math.pow(2,7),zd=Math.pow(2,14),Md=Math.pow(2,21),bn=Math.pow(2,28),En=Math.pow(2,35),Sn=Math.pow(2,42),Pn=Math.pow(2,49),U=128,q=127;function ye(e){if(e<jd)return 1;if(e<zd)return 2;if(e<Md)return 3;if(e<bn)return 4;if(e<En)return 5;if(e<Sn)return 6;if(e<Pn)return 7;if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function Vd(e,r,t=0){switch(ye(e)){case 8:r[t++]=e&255|U,e/=128;case 7:r[t++]=e&255|U,e/=128;case 6:r[t++]=e&255|U,e/=128;case 5:r[t++]=e&255|U,e/=128;case 4:r[t++]=e&255|U,e>>>=7;case 3:r[t++]=e&255|U,e>>>=7;case 2:r[t++]=e&255|U,e>>>=7;case 1:{r[t++]=e&255,e>>>=7;break}default:throw new Error("unreachable")}return r}function Hd(e,r,t=0){switch(ye(e)){case 8:r.set(t++,e&255|U),e/=128;case 7:r.set(t++,e&255|U),e/=128;case 6:r.set(t++,e&255|U),e/=128;case 5:r.set(t++,e&255|U),e/=128;case 4:r.set(t++,e&255|U),e>>>=7;case 3:r.set(t++,e&255|U),e>>>=7;case 2:r.set(t++,e&255|U),e>>>=7;case 1:{r.set(t++,e&255),e>>>=7;break}default:throw new Error("unreachable")}return r}function qd(e,r){let t=e[r],n=0;if(n+=t&q,t<U||(t=e[r+1],n+=(t&q)<<7,t<U)||(t=e[r+2],n+=(t&q)<<14,t<U)||(t=e[r+3],n+=(t&q)<<21,t<U)||(t=e[r+4],n+=(t&q)*bn,t<U)||(t=e[r+5],n+=(t&q)*En,t<U)||(t=e[r+6],n+=(t&q)*Sn,t<U)||(t=e[r+7],n+=(t&q)*Pn,t<U))return n;throw new RangeError("Could not decode varint")}function Gd(e,r){let t=e.get(r),n=0;if(n+=t&q,t<U||(t=e.get(r+1),n+=(t&q)<<7,t<U)||(t=e.get(r+2),n+=(t&q)<<14,t<U)||(t=e.get(r+3),n+=(t&q)<<21,t<U)||(t=e.get(r+4),n+=(t&q)*bn,t<U)||(t=e.get(r+5),n+=(t&q)*En,t<U)||(t=e.get(r+6),n+=(t&q)*Sn,t<U)||(t=e.get(r+7),n+=(t&q)*Pn,t<U))return n;throw new RangeError("Could not decode varint")}function We(e,r,t=0){return r==null&&(r=Ge(ye(e))),r instanceof Uint8Array?Vd(e,r,t):Hd(e,r,t)}function $e(e,r=0){return e instanceof Uint8Array?qd(e,r):Gd(e,r)}function we(e,r){r==null&&(r=e.reduce((o,s)=>o+s.length,0));let t=Ge(r),n=0;for(let o of e)t.set(o,n),n+=o.length;return t}var Yr=class{index=0;input="";new(r){return this.index=0,this.input=r,this}readAtomically(r){let t=this.index,n=r();return n===void 0&&(this.index=t),n}parseWith(r){let t=r();if(this.index===this.input.length)return t}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(r){return this.readAtomically(()=>{let t=this.readChar();if(t===r)return t})}readSeparator(r,t,n){return this.readAtomically(()=>{if(!(t>0&&this.readGivenChar(r)===void 0))return n()})}readNumber(r,t,n,o){return this.readAtomically(()=>{let s=0,i=0,a=this.peekChar();if(a===void 0)return;let f=a==="0",h=2**(8*o)-1;for(;;){let d=this.readAtomically(()=>{let p=this.readChar();if(p===void 0)return;let b=Number.parseInt(p,r);if(!Number.isNaN(b))return b});if(d===void 0)break;if(s*=r,s+=d,s>h||(i+=1,t!==void 0&&i>t))return}if(i!==0)return!n&&f&&i>1?void 0:s})}readIPv4Addr(){return this.readAtomically(()=>{let r=new Uint8Array(4);for(let t=0;t<r.length;t++){let n=this.readSeparator(".",t,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;r[t]=n}return r})}readIPv6Addr(){let r=t=>{for(let n=0;n<t.length/2;n++){let o=n*2;if(n<t.length-3){let i=this.readSeparator(":",n,()=>this.readIPv4Addr());if(i!==void 0)return t[o]=i[0],t[o+1]=i[1],t[o+2]=i[2],t[o+3]=i[3],[o+4,!0]}let s=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(s===void 0)return[o,!1];t[o]=s>>8,t[o+1]=s&255}return[t.length,!1]};return this.readAtomically(()=>{let t=new Uint8Array(16),[n,o]=r(t);if(n===16)return t;if(o||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let s=new Uint8Array(14),i=16-(n+2),[a]=r(s.subarray(0,i));return t.set(s.subarray(0,a),16-a),t})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var Us=45,Wd=15,Je=new Yr;function An(e){if(!(e.length>Wd))return Je.new(e).parseWith(()=>Je.readIPv4Addr())}function Cn(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>Us))return Je.new(e).parseWith(()=>Je.readIPv6Addr())}function Zr(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>Us))return Je.new(e).parseWith(()=>Je.readIPAddr())}var Qy=parseInt("0xFFFF",16),Yy=new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);function ue(e,r="utf8"){let t=Qr[r];if(t==null)throw new Error(`Unsupported encoding "${r}"`);return t.decoder.decode(`${t.prefix}${e}`)}function Ns(e){return!!An(e)}function Bs(e){return!!Cn(e)}function et(e){return!!Zr(e)}var Ds=Ns,Yd=Bs,vn=function(e){let r=0;if(e=e.toString().trim(),Ds(e)){let t=new Uint8Array(r+4);return e.split(/\./g).forEach(n=>{t[r++]=parseInt(n,10)&255}),t}if(Yd(e)){let t=e.split(":",8),n;for(n=0;n<t.length;n++){let s=Ds(t[n]),i;s&&(i=vn(t[n]),t[n]=D(i.slice(0,2),"base16")),i!=null&&++n<8&&t.splice(n,0,D(i.slice(2,4),"base16"))}if(t[0]==="")for(;t.length<8;)t.unshift("0");else if(t[t.length-1]==="")for(;t.length<8;)t.push("0");else if(t.length<8){for(n=0;n<t.length&&t[n]!=="";n++);let s=[n,1];for(n=9-t.length;n>0;n--)s.push("0");t.splice.apply(t,s)}let o=new Uint8Array(r+16);for(n=0;n<t.length;n++){let s=parseInt(t[n],16);o[r++]=s>>8&255,o[r++]=s&255}return o}throw new Error("invalid ip address")},_s=function(e,r=0,t){r=~~r,t=t??e.length-r;let n=new DataView(e.buffer);if(t===4){let o=[];for(let s=0;s<t;s++)o.push(e[r+s]);return o.join(".")}if(t===16){let o=[];for(let s=0;s<t;s+=2)o.push(n.getUint16(r+s).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var Ke={},In={},el=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[481,-1,"http-path"],[777,-1,"memory"]];el.forEach(e=>{let r=rl(...e);In[r.code]=r,Ke[r.name]=r});function rl(e,r,t,n,o){return{code:e,size:r,name:t,resolvable:!!n,path:!!o}}function E(e){if(typeof e=="number"){if(In[e]!=null)return In[e];throw new Error(`no protocol with code: ${e}`)}else if(typeof e=="string"){if(Ke[e]!=null)return Ke[e];throw new Error(`no protocol with name: ${e}`)}throw new Error(`invalid protocol id type: ${typeof e}`)}var Lg=E("ip4"),Og=E("ip6"),Fg=E("ipcidr");function Nn(e,r){switch(E(e).code){case 4:case 41:return nl(r);case 42:return kn(r);case 6:case 273:case 33:case 132:return Ls(r).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return kn(r);case 421:return al(r);case 444:return $s(r);case 445:return $s(r);case 466:return il(r);case 481:return globalThis.encodeURIComponent(kn(r));default:return D(r,"base16")}}function Bn(e,r){switch(E(e).code){case 4:return Rs(r);case 41:return Rs(r);case 42:return Tn(r);case 6:case 273:case 33:case 132:return Dn(parseInt(r,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Tn(r);case 421:return ol(r);case 444:return cl(r);case 445:return ul(r);case 466:return sl(r);case 481:return Tn(globalThis.decodeURIComponent(r));default:return ue(r,"base16")}}var Un=Object.values(he).map(e=>e.decoder),tl=function(){let e=Un[0].or(Un[1]);return Un.slice(2).forEach(r=>e=e.or(r)),e}();function Rs(e){if(!et(e))throw new Error("invalid ip address");return vn(e)}function nl(e){let r=_s(e,0,e.length);if(r==null)throw new Error("ipBuff is required");if(!et(r))throw new Error("invalid ip address");return r}function Dn(e){let r=new ArrayBuffer(2);return new DataView(r).setUint16(0,e),new Uint8Array(r)}function Ls(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function Tn(e){let r=ue(e),t=Uint8Array.from(We(r.length));return we([t,r],t.length+r.length)}function kn(e){let r=$e(e);if(e=e.slice(ye(r)),e.length!==r)throw new Error("inconsistent lengths");return D(e)}function ol(e){let r;e[0]==="Q"||e[0]==="1"?r=_e(z.decode(`z${e}`)).bytes:r=m.parse(e).multihash.bytes;let t=Uint8Array.from(We(r.length));return we([t,r],t.length+r.length)}function sl(e){let r=tl.decode(e),t=Uint8Array.from(We(r.length));return we([t,r],t.length+r.length)}function il(e){let r=$e(e),t=e.slice(ye(r));if(t.length!==r)throw new Error("inconsistent lengths");return"u"+D(t,"base64url")}function al(e){let r=$e(e),t=e.slice(ye(r));if(t.length!==r)throw new Error("inconsistent lengths");return D(t,"base58btc")}function cl(e){let r=e.split(":");if(r.length!==2)throw new Error(`failed to parse onion addr: ["'${r.join('", "')}'"]' does not contain a port number`);if(r[0].length!==16)throw new Error(`failed to parse onion addr: ${r[0]} not a Tor onion address.`);let t=ce.decode("b"+r[0]),n=parseInt(r[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=Dn(n);return we([t,o],t.length+o.length)}function ul(e){let r=e.split(":");if(r.length!==2)throw new Error(`failed to parse onion addr: ["'${r.join('", "')}'"]' does not contain a port number`);if(r[0].length!==56)throw new Error(`failed to parse onion addr: ${r[0]} not a Tor onion3 address.`);let t=ce.decode(`b${r[0]}`),n=parseInt(r[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=Dn(n);return we([t,o],t.length+o.length)}function $s(e){let r=e.slice(0,e.length-2),t=e.slice(e.length-2),n=D(r,"base32"),o=Ls(t);return`${n}:${o}`}function Os(e){e=_n(e);let r=[],t=[],n=null,o=e.split("/").slice(1);if(o.length===1&&o[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<o.length;s++){let i=o[s],a=E(i);if(a.size===0){r.push([a.code]),t.push([a.code]);continue}if(s++,s>=o.length)throw js("invalid address: "+e);if(a.path===!0){n=_n(o.slice(s).join("/")),r.push([a.code,Bn(a.code,n)]),t.push([a.code,n]);break}let f=Bn(a.code,o[s]);r.push([a.code,f]),t.push([a.code,Nn(a.code,f)])}return{string:Fs(t),bytes:$n(r),tuples:r,stringTuples:t,path:n}}function Rn(e){let r=[],t=[],n=null,o=0;for(;o<e.length;){let s=$e(e,o),i=ye(s),a=E(s),f=fl(a,e.slice(o+i));if(f===0){r.push([s]),t.push([s]),o+=i;continue}let h=e.slice(o+i,o+i+f);if(o+=f+i,o>e.length)throw js("Invalid address Uint8Array: "+D(e,"base16"));r.push([s,h]);let d=Nn(s,h);if(t.push([s,d]),a.path===!0){n=d;break}}return{bytes:Uint8Array.from(e),string:Fs(t),tuples:r,stringTuples:t,path:n}}function Fs(e){let r=[];return e.map(t=>{let n=E(t[0]);return r.push(n.name),t.length>1&&t[1]!=null&&r.push(t[1]),null}),_n(r.join("/"))}function $n(e){return we(e.map(r=>{let t=E(r[0]),n=Uint8Array.from(We(t.code));return r.length>1&&r[1]!=null&&(n=we([n,r[1]])),n}))}function fl(e,r){if(e.size>0)return e.size/8;if(e.size===0)return 0;{let t=$e(r instanceof Uint8Array?r:Uint8Array.from(r));return t+ye(t)}}function _n(e){return"/"+e.trim().split("/").filter(r=>r).join("/")}function js(e){return new Error("Error parsing address: "+e)}var dl=Symbol.for("nodejs.util.inspect.custom"),On=Symbol.for("@multiformats/js-multiaddr/multiaddr"),ll=[E("dns").code,E("dns4").code,E("dns6").code,E("dnsaddr").code],Ln=class extends Error{constructor(r="No available resolver"){super(r),this.name="NoAvailableResolverError"}},rt=class e{bytes;#r;#e;#t;#n;[On]=!0;constructor(r){r==null&&(r="");let t;if(r instanceof Uint8Array)t=Rn(r);else if(typeof r=="string"){if(r.length>0&&r.charAt(0)!=="/")throw new Error(`multiaddr "${r}" must start with a "/"`);t=Os(r)}else if(Le(r))t=Rn(r.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=t.bytes,this.#r=t.string,this.#e=t.tuples,this.#t=t.stringTuples,this.#n=t.path}toString(){return this.#r}toJSON(){return this.toString()}toOptions(){let r,t,n,o,s="",i=E("tcp"),a=E("udp"),f=E("ip4"),h=E("ip6"),d=E("dns6"),p=E("ip6zone");for(let[T,g]of this.stringTuples())T===p.code&&(s=`%${g??""}`),ll.includes(T)&&(t=i.name,o=443,n=`${g??""}${s}`,r=T===d.code?6:4),(T===i.code||T===a.code)&&(t=E(T).name,o=parseInt(g??"")),(T===f.code||T===h.code)&&(t=E(T).name,n=`${g??""}${s}`,r=T===h.code?6:4);if(r==null||t==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:r,host:n,transport:t,port:o}}protos(){return this.#e.map(([r])=>Object.assign({},E(r)))}protoCodes(){return this.#e.map(([r])=>r)}protoNames(){return this.#e.map(([r])=>E(r).name)}tuples(){return this.#e}stringTuples(){return this.#t}encapsulate(r){return r=new e(r),new e(this.toString()+r.toString())}decapsulate(r){let t=r.toString(),n=this.toString(),o=n.lastIndexOf(t);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${r.toString()}`);return new e(n.slice(0,o))}decapsulateCode(r){let t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===r)return new e($n(t.slice(0,n)));return this}getPeerId(){try{let r=[];this.stringTuples().forEach(([n,o])=>{n===Ke.p2p.code&&r.push([n,o]),n===Ke["p2p-circuit"].code&&(r=[])});let t=r.pop();if(t?.[1]!=null){let n=t[1];return n[0]==="Q"||n[0]==="1"?D(z.decode(`z${n}`),"base58btc"):D(m.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return this.#n}equals(r){return Pr(this.bytes,r.bytes)}async resolve(r){let t=this.protos().find(s=>s.resolvable);if(t==null)return[this];let n=zs.get(t.name);if(n==null)throw new Ln(`no available resolver for ${t.name}`);return(await n(this,r)).map(s=>k(s))}nodeAddress(){let r=this.toOptions();if(r.transport!=="tcp"&&r.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${r.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:r.family,address:r.host,port:r.port}}isThinWaistAddress(r){let t=(r??this).protos();return!(t.length!==2||t[0].code!==4&&t[0].code!==41||t[1].code!==6&&t[1].code!==273)}[dl](){return`Multiaddr(${this.#r})`}};var zs=new Map;function Le(e){return!!e?.[On]}function k(e){return new rt(e)}var yt={};j(yt,{code:()=>Jl,decode:()=>Xn,decodeOptions:()=>Gl,encode:()=>Kn,encodeOptions:()=>Hl,name:()=>Wl,toByteView:()=>Gi});var pl=["string","number","bigint","symbol"],ml=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Ms(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";let r=typeof e;if(pl.includes(r))return r;if(r==="function")return"Function";if(Array.isArray(e))return"Array";if(hl(e))return"Buffer";let t=yl(e);return t||"Object"}function hl(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function yl(e){let r=Object.prototype.toString.call(e).slice(8,-1);if(ml.includes(r))return r}var c=class{constructor(r,t,n){this.major=r,this.majorEncoded=r<<5,this.name=t,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(r){return this.major<r.major?-1:this.major>r.major?1:0}};c.uint=new c(0,"uint",!0);c.negint=new c(1,"negint",!0);c.bytes=new c(2,"bytes",!0);c.string=new c(3,"string",!0);c.array=new c(4,"array",!1);c.map=new c(5,"map",!1);c.tag=new c(6,"tag",!1);c.float=new c(7,"float",!0);c.false=new c(7,"false",!0);c.true=new c(7,"true",!0);c.null=new c(7,"null",!0);c.undefined=new c(7,"undefined",!0);c.break=new c(7,"break",!0);var l=class{constructor(r,t,n){this.type=r,this.value=t,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}};var Xe=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",gl=new TextDecoder,wl=new TextEncoder;function tt(e){return Xe&&globalThis.Buffer.isBuffer(e)}function Cr(e){return e instanceof Uint8Array?tt(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}var Gs=Xe?(e,r,t)=>t-r>64?globalThis.Buffer.from(e.subarray(r,t)).toString("utf8"):Hs(e,r,t):(e,r,t)=>t-r>64?gl.decode(e.subarray(r,t)):Hs(e,r,t),nt=Xe?e=>e.length>64?globalThis.Buffer.from(e):Vs(e):e=>e.length>64?wl.encode(e):Vs(e),ge=e=>Uint8Array.from(e),Qe=Xe?(e,r,t)=>tt(e)?new Uint8Array(e.subarray(r,t)):e.slice(r,t):(e,r,t)=>e.slice(r,t),Ws=Xe?(e,r)=>(e=e.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),Cr(globalThis.Buffer.concat(e,r))):(e,r)=>{let t=new Uint8Array(r),n=0;for(let o of e)n+o.length>t.length&&(o=o.subarray(0,t.length-n)),t.set(o,n),n+=o.length;return t},Js=Xe?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function Ks(e,r){if(tt(e)&&tt(r))return e.compare(r);for(let t=0;t<e.length;t++)if(e[t]!==r[t])return e[t]<r[t]?-1:1;return 0}function Vs(e){let r=[],t=0;for(let n=0;n<e.length;n++){let o=e.charCodeAt(n);o<128?r[t++]=o:o<2048?(r[t++]=o>>6|192,r[t++]=o&63|128):(o&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(o=65536+((o&1023)<<10)+(e.charCodeAt(++n)&1023),r[t++]=o>>18|240,r[t++]=o>>12&63|128,r[t++]=o>>6&63|128,r[t++]=o&63|128):(r[t++]=o>>12|224,r[t++]=o>>6&63|128,r[t++]=o&63|128)}return r}function Hs(e,r,t){let n=[];for(;r<t;){let o=e[r],s=null,i=o>239?4:o>223?3:o>191?2:1;if(r+i<=t){let a,f,h,d;switch(i){case 1:o<128&&(s=o);break;case 2:a=e[r+1],(a&192)===128&&(d=(o&31)<<6|a&63,d>127&&(s=d));break;case 3:a=e[r+1],f=e[r+2],(a&192)===128&&(f&192)===128&&(d=(o&15)<<12|(a&63)<<6|f&63,d>2047&&(d<55296||d>57343)&&(s=d));break;case 4:a=e[r+1],f=e[r+2],h=e[r+3],(a&192)===128&&(f&192)===128&&(h&192)===128&&(d=(o&15)<<18|(a&63)<<12|(f&63)<<6|h&63,d>65535&&d<1114112&&(s=d))}}s===null?(s=65533,i=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|s&1023),n.push(s),r+=i}return Fn(n)}var qs=4096;function Fn(e){let r=e.length;if(r<=qs)return String.fromCharCode.apply(String,e);let t="",n=0;for(;n<r;)t+=String.fromCharCode.apply(String,e.slice(n,n+=qs));return t}var xl=256,vr=class{constructor(r=xl){this.chunkSize=r,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(r){let t=this.chunks[this.chunks.length-1];if(this.cursor+r.length<=this.maxCursor+1){let o=t.length-(this.maxCursor-this.cursor)-1;t.set(r,o)}else{if(t){let o=t.length-(this.maxCursor-this.cursor)-1;o<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,o),this.maxCursor=this.cursor-1)}r.length<64&&r.length<this.chunkSize?(t=Js(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(r,0)):(this.chunks.push(r),this.maxCursor+=r.length)}this.cursor+=r.length}toBytes(r=!1){let t;if(this.chunks.length===1){let n=this.chunks[0];r&&this.cursor>n.length/2?(t=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=Qe(n,0,this.cursor)}else t=Ws(this.chunks,this.cursor);return r&&this.reset(),t}};var w="CBOR decode error:",xe="CBOR encode error:",Ir=[];Ir[23]=1;Ir[24]=2;Ir[25]=3;Ir[26]=5;Ir[27]=9;function be(e,r,t){if(e.length-r<t)throw new Error(`${w} not enough data for type`)}var M=[24,256,65536,4294967296,BigInt("18446744073709551616")];function X(e,r,t){be(e,r,1);let n=e[r];if(t.strict===!0&&n<M[0])throw new Error(`${w} integer encoded in more bytes than necessary (strict decode)`);return n}function Q(e,r,t){be(e,r,2);let n=e[r]<<8|e[r+1];if(t.strict===!0&&n<M[1])throw new Error(`${w} integer encoded in more bytes than necessary (strict decode)`);return n}function Y(e,r,t){be(e,r,4);let n=e[r]*16777216+(e[r+1]<<16)+(e[r+2]<<8)+e[r+3];if(t.strict===!0&&n<M[2])throw new Error(`${w} integer encoded in more bytes than necessary (strict decode)`);return n}function Z(e,r,t){be(e,r,8);let n=e[r]*16777216+(e[r+1]<<16)+(e[r+2]<<8)+e[r+3],o=e[r+4]*16777216+(e[r+5]<<16)+(e[r+6]<<8)+e[r+7],s=(BigInt(n)<<BigInt(32))+BigInt(o);if(t.strict===!0&&s<M[3])throw new Error(`${w} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(t.allowBigInt===!0)return s;throw new Error(`${w} integers outside of the safe integer range are not supported`)}function Xs(e,r,t,n){return new l(c.uint,X(e,r+1,n),2)}function Qs(e,r,t,n){return new l(c.uint,Q(e,r+1,n),3)}function Ys(e,r,t,n){return new l(c.uint,Y(e,r+1,n),5)}function Zs(e,r,t,n){return new l(c.uint,Z(e,r+1,n),9)}function re(e,r){return H(e,0,r.value)}function H(e,r,t){if(t<M[0]){let n=Number(t);e.push([r|n])}else if(t<M[1]){let n=Number(t);e.push([r|24,n])}else if(t<M[2]){let n=Number(t);e.push([r|25,n>>>8,n&255])}else if(t<M[3]){let n=Number(t);e.push([r|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(t);if(n<M[4]){let o=[r|27,0,0,0,0,0,0,0],s=Number(n&BigInt(4294967295)),i=Number(n>>BigInt(32)&BigInt(4294967295));o[8]=s&255,s=s>>8,o[7]=s&255,s=s>>8,o[6]=s&255,s=s>>8,o[5]=s&255,o[4]=i&255,i=i>>8,o[3]=i&255,i=i>>8,o[2]=i&255,i=i>>8,o[1]=i&255,e.push(o)}else throw new Error(`${w} encountered BigInt larger than allowable range`)}}re.encodedSize=function(r){return H.encodedSize(r.value)};H.encodedSize=function(r){return r<M[0]?1:r<M[1]?2:r<M[2]?3:r<M[3]?5:9};re.compareTokens=function(r,t){return r.value<t.value?-1:r.value>t.value?1:0};function ei(e,r,t,n){return new l(c.negint,-1-X(e,r+1,n),2)}function ri(e,r,t,n){return new l(c.negint,-1-Q(e,r+1,n),3)}function ti(e,r,t,n){return new l(c.negint,-1-Y(e,r+1,n),5)}var jn=BigInt(-1),ni=BigInt(1);function oi(e,r,t,n){let o=Z(e,r+1,n);if(typeof o!="bigint"){let s=-1-o;if(s>=Number.MIN_SAFE_INTEGER)return new l(c.negint,s,9)}if(n.allowBigInt!==!0)throw new Error(`${w} integers outside of the safe integer range are not supported`);return new l(c.negint,jn-BigInt(o),9)}function ot(e,r){let t=r.value,n=typeof t=="bigint"?t*jn-ni:t*-1-1;H(e,r.type.majorEncoded,n)}ot.encodedSize=function(r){let t=r.value,n=typeof t=="bigint"?t*jn-ni:t*-1-1;return n<M[0]?1:n<M[1]?2:n<M[2]?3:n<M[3]?5:9};ot.compareTokens=function(r,t){return r.value<t.value?1:r.value>t.value?-1:0};function Ur(e,r,t,n){be(e,r,t+n);let o=Qe(e,r+t,r+t+n);return new l(c.bytes,o,t+n)}function si(e,r,t,n){return Ur(e,r,1,t)}function ii(e,r,t,n){return Ur(e,r,2,X(e,r+1,n))}function ai(e,r,t,n){return Ur(e,r,3,Q(e,r+1,n))}function ci(e,r,t,n){return Ur(e,r,5,Y(e,r+1,n))}function ui(e,r,t,n){let o=Z(e,r+1,n);if(typeof o=="bigint")throw new Error(`${w} 64-bit integer bytes lengths not supported`);return Ur(e,r,9,o)}function st(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===c.string?nt(e.value):e.value),e.encodedBytes}function Ye(e,r){let t=st(r);H(e,r.type.majorEncoded,t.length),e.push(t)}Ye.encodedSize=function(r){let t=st(r);return H.encodedSize(t.length)+t.length};Ye.compareTokens=function(r,t){return El(st(r),st(t))};function El(e,r){return e.length<r.length?-1:e.length>r.length?1:Ks(e,r)}function Tr(e,r,t,n,o){let s=t+n;be(e,r,s);let i=new l(c.string,Gs(e,r+t,r+s),s);return o.retainStringBytes===!0&&(i.byteValue=Qe(e,r+t,r+s)),i}function fi(e,r,t,n){return Tr(e,r,1,t,n)}function di(e,r,t,n){return Tr(e,r,2,X(e,r+1,n),n)}function li(e,r,t,n){return Tr(e,r,3,Q(e,r+1,n),n)}function pi(e,r,t,n){return Tr(e,r,5,Y(e,r+1,n),n)}function mi(e,r,t,n){let o=Z(e,r+1,n);if(typeof o=="bigint")throw new Error(`${w} 64-bit integer string lengths not supported`);return Tr(e,r,9,o,n)}var hi=Ye;function Ze(e,r,t,n){return new l(c.array,n,t)}function yi(e,r,t,n){return Ze(e,r,1,t)}function gi(e,r,t,n){return Ze(e,r,2,X(e,r+1,n))}function wi(e,r,t,n){return Ze(e,r,3,Q(e,r+1,n))}function xi(e,r,t,n){return Ze(e,r,5,Y(e,r+1,n))}function bi(e,r,t,n){let o=Z(e,r+1,n);if(typeof o=="bigint")throw new Error(`${w} 64-bit integer array lengths not supported`);return Ze(e,r,9,o)}function Ei(e,r,t,n){if(n.allowIndefinite===!1)throw new Error(`${w} indefinite length items not allowed`);return Ze(e,r,1,1/0)}function it(e,r){H(e,c.array.majorEncoded,r.value)}it.compareTokens=re.compareTokens;it.encodedSize=function(r){return H.encodedSize(r.value)};function er(e,r,t,n){return new l(c.map,n,t)}function Si(e,r,t,n){return er(e,r,1,t)}function Pi(e,r,t,n){return er(e,r,2,X(e,r+1,n))}function Ai(e,r,t,n){return er(e,r,3,Q(e,r+1,n))}function Ci(e,r,t,n){return er(e,r,5,Y(e,r+1,n))}function vi(e,r,t,n){let o=Z(e,r+1,n);if(typeof o=="bigint")throw new Error(`${w} 64-bit integer map lengths not supported`);return er(e,r,9,o)}function Ii(e,r,t,n){if(n.allowIndefinite===!1)throw new Error(`${w} indefinite length items not allowed`);return er(e,r,1,1/0)}function at(e,r){H(e,c.map.majorEncoded,r.value)}at.compareTokens=re.compareTokens;at.encodedSize=function(r){return H.encodedSize(r.value)};function Ui(e,r,t,n){return new l(c.tag,t,1)}function Ti(e,r,t,n){return new l(c.tag,X(e,r+1,n),2)}function ki(e,r,t,n){return new l(c.tag,Q(e,r+1,n),3)}function Ni(e,r,t,n){return new l(c.tag,Y(e,r+1,n),5)}function Bi(e,r,t,n){return new l(c.tag,Z(e,r+1,n),9)}function ct(e,r){H(e,c.tag.majorEncoded,r.value)}ct.compareTokens=re.compareTokens;ct.encodedSize=function(r){return H.encodedSize(r.value)};var Il=20,Ul=21,Tl=22,kl=23;function Di(e,r,t,n){if(n.allowUndefined===!1)throw new Error(`${w} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new l(c.null,null,1):new l(c.undefined,void 0,1)}function _i(e,r,t,n){if(n.allowIndefinite===!1)throw new Error(`${w} indefinite length items not allowed`);return new l(c.break,void 0,1)}function zn(e,r,t){if(t){if(t.allowNaN===!1&&Number.isNaN(e))throw new Error(`${w} NaN values are not supported`);if(t.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${w} Infinity values are not supported`)}return new l(c.float,e,r)}function Ri(e,r,t,n){return zn(Mn(e,r+1),3,n)}function $i(e,r,t,n){return zn(Vn(e,r+1),5,n)}function Li(e,r,t,n){return zn(zi(e,r+1),9,n)}function ut(e,r,t){let n=r.value;if(n===!1)e.push([c.float.majorEncoded|Il]);else if(n===!0)e.push([c.float.majorEncoded|Ul]);else if(n===null)e.push([c.float.majorEncoded|Tl]);else if(n===void 0)e.push([c.float.majorEncoded|kl]);else{let o,s=!1;(!t||t.float64!==!0)&&(Fi(n),o=Mn(fe,1),n===o||Number.isNaN(n)?(fe[0]=249,e.push(fe.slice(0,3)),s=!0):(ji(n),o=Vn(fe,1),n===o&&(fe[0]=250,e.push(fe.slice(0,5)),s=!0))),s||(Nl(n),o=zi(fe,1),fe[0]=251,e.push(fe.slice(0,9)))}}ut.encodedSize=function(r,t){let n=r.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!t||t.float64!==!0){Fi(n);let o=Mn(fe,1);if(n===o||Number.isNaN(n))return 3;if(ji(n),o=Vn(fe,1),n===o)return 5}return 9};var Oi=new ArrayBuffer(9),te=new DataView(Oi,1),fe=new Uint8Array(Oi,0);function Fi(e){if(e===1/0)te.setUint16(0,31744,!1);else if(e===-1/0)te.setUint16(0,64512,!1);else if(Number.isNaN(e))te.setUint16(0,32256,!1);else{te.setFloat32(0,e);let r=te.getUint32(0),t=(r&2139095040)>>23,n=r&8388607;if(t===255)te.setUint16(0,31744,!1);else if(t===0)te.setUint16(0,(e&2147483648)>>16|n>>13,!1);else{let o=t-127;o<-24?te.setUint16(0,0):o<-14?te.setUint16(0,(r&2147483648)>>16|1<<24+o,!1):te.setUint16(0,(r&2147483648)>>16|o+15<<10|n>>13,!1)}}}function Mn(e,r){if(e.length-r<2)throw new Error(`${w} not enough data for float16`);let t=(e[r]<<8)+e[r+1];if(t===31744)return 1/0;if(t===64512)return-1/0;if(t===32256)return NaN;let n=t>>10&31,o=t&1023,s;return n===0?s=o*2**-24:n!==31?s=(o+1024)*2**(n-25):s=o===0?1/0:NaN,t&32768?-s:s}function ji(e){te.setFloat32(0,e,!1)}function Vn(e,r){if(e.length-r<4)throw new Error(`${w} not enough data for float32`);let t=(e.byteOffset||0)+r;return new DataView(e.buffer,t,4).getFloat32(0,!1)}function Nl(e){te.setFloat64(0,e,!1)}function zi(e,r){if(e.length-r<8)throw new Error(`${w} not enough data for float64`);let t=(e.byteOffset||0)+r;return new DataView(e.buffer,t,8).getFloat64(0,!1)}ut.compareTokens=re.compareTokens;function v(e,r,t){throw new Error(`${w} encountered invalid minor (${t}) for major ${e[r]>>>5}`)}function ft(e){return()=>{throw new Error(`${w} ${e}`)}}var y=[];for(let e=0;e<=23;e++)y[e]=v;y[24]=Xs;y[25]=Qs;y[26]=Ys;y[27]=Zs;y[28]=v;y[29]=v;y[30]=v;y[31]=v;for(let e=32;e<=55;e++)y[e]=v;y[56]=ei;y[57]=ri;y[58]=ti;y[59]=oi;y[60]=v;y[61]=v;y[62]=v;y[63]=v;for(let e=64;e<=87;e++)y[e]=si;y[88]=ii;y[89]=ai;y[90]=ci;y[91]=ui;y[92]=v;y[93]=v;y[94]=v;y[95]=ft("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)y[e]=fi;y[120]=di;y[121]=li;y[122]=pi;y[123]=mi;y[124]=v;y[125]=v;y[126]=v;y[127]=ft("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)y[e]=yi;y[152]=gi;y[153]=wi;y[154]=xi;y[155]=bi;y[156]=v;y[157]=v;y[158]=v;y[159]=Ei;for(let e=160;e<=183;e++)y[e]=Si;y[184]=Pi;y[185]=Ai;y[186]=Ci;y[187]=vi;y[188]=v;y[189]=v;y[190]=v;y[191]=Ii;for(let e=192;e<=215;e++)y[e]=Ui;y[216]=Ti;y[217]=ki;y[218]=Ni;y[219]=Bi;y[220]=v;y[221]=v;y[222]=v;y[223]=v;for(let e=224;e<=243;e++)y[e]=ft("simple values are not supported");y[244]=v;y[245]=v;y[246]=v;y[247]=Di;y[248]=ft("simple values are not supported");y[249]=Ri;y[250]=$i;y[251]=Li;y[252]=v;y[253]=v;y[254]=v;y[255]=_i;var de=[];for(let e=0;e<24;e++)de[e]=new l(c.uint,e,1);for(let e=-1;e>=-24;e--)de[31-e]=new l(c.negint,e,1);de[64]=new l(c.bytes,new Uint8Array(0),1);de[96]=new l(c.string,"",1);de[128]=new l(c.array,0,1);de[160]=new l(c.map,0,1);de[244]=new l(c.false,!1,1);de[245]=new l(c.true,!0,1);de[246]=new l(c.null,null,1);function Mi(e){switch(e.type){case c.false:return ge([244]);case c.true:return ge([245]);case c.null:return ge([246]);case c.bytes:return e.value.length?void 0:ge([64]);case c.string:return e.value===""?ge([96]):void 0;case c.array:return e.value===0?ge([128]):void 0;case c.map:return e.value===0?ge([160]):void 0;case c.uint:return e.value<24?ge([Number(e.value)]):void 0;case c.negint:if(e.value>=-24)return ge([31-Number(e.value)])}}var Dl={float64:!1,mapSorter:$l,quickEncodeToken:Mi};function _l(){let e=[];return e[c.uint.major]=re,e[c.negint.major]=ot,e[c.bytes.major]=Ye,e[c.string.major]=hi,e[c.array.major]=it,e[c.map.major]=at,e[c.tag.major]=ct,e[c.float.major]=ut,e}var Vi=_l(),Hn=new vr,lt=class e{constructor(r,t){this.obj=r,this.parent=t}includes(r){let t=this;do if(t.obj===r)return!0;while(t=t.parent);return!1}static createCheck(r,t){if(r&&r.includes(t))throw new Error(`${xe} object contains circular references`);return new e(t,r)}},Ie={null:new l(c.null,null),undefined:new l(c.undefined,void 0),true:new l(c.true,!0),false:new l(c.false,!1),emptyArray:new l(c.array,0),emptyMap:new l(c.map,0)},Ue={number(e,r,t,n){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new l(c.float,e):e>=0?new l(c.uint,e):new l(c.negint,e)},bigint(e,r,t,n){return e>=BigInt(0)?new l(c.uint,e):new l(c.negint,e)},Uint8Array(e,r,t,n){return new l(c.bytes,e)},string(e,r,t,n){return new l(c.string,e)},boolean(e,r,t,n){return e?Ie.true:Ie.false},null(e,r,t,n){return Ie.null},undefined(e,r,t,n){return Ie.undefined},ArrayBuffer(e,r,t,n){return new l(c.bytes,new Uint8Array(e))},DataView(e,r,t,n){return new l(c.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,r,t,n){if(!e.length)return t.addBreakTokens===!0?[Ie.emptyArray,new l(c.break)]:Ie.emptyArray;n=lt.createCheck(n,e);let o=[],s=0;for(let i of e)o[s++]=dt(i,t,n);return t.addBreakTokens?[new l(c.array,e.length),o,new l(c.break)]:[new l(c.array,e.length),o]},Object(e,r,t,n){let o=r!=="Object",s=o?e.keys():Object.keys(e),i=o?e.size:s.length;if(!i)return t.addBreakTokens===!0?[Ie.emptyMap,new l(c.break)]:Ie.emptyMap;n=lt.createCheck(n,e);let a=[],f=0;for(let h of s)a[f++]=[dt(h,t,n),dt(o?e.get(h):e[h],t,n)];return Rl(a,t),t.addBreakTokens?[new l(c.map,i),a,new l(c.break)]:[new l(c.map,i),a]}};Ue.Map=Ue.Object;Ue.Buffer=Ue.Uint8Array;for(let e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Ue[`${e}Array`]=Ue.DataView;function dt(e,r={},t){let n=Ms(e),o=r&&r.typeEncoders&&r.typeEncoders[n]||Ue[n];if(typeof o=="function"){let i=o(e,n,r,t);if(i!=null)return i}let s=Ue[n];if(!s)throw new Error(`${xe} unsupported type: ${n}`);return s(e,n,r,t)}function Rl(e,r){r.mapSorter&&e.sort(r.mapSorter)}function $l(e,r){let t=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(r[0])?r[0][0]:r[0];if(t.type!==n.type)return t.type.compare(n.type);let o=t.type.major,s=Vi[o].compareTokens(t,n);return s===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),s}function Hi(e,r,t,n){if(Array.isArray(r))for(let o of r)Hi(e,o,t,n);else t[r.type.major](e,r,n)}function qn(e,r,t){let n=dt(e,t);if(!Array.isArray(n)&&t.quickEncodeToken){let o=t.quickEncodeToken(n);if(o)return o;let s=r[n.type.major];if(s.encodedSize){let i=s.encodedSize(n,t),a=new vr(i);if(s(a,n,t),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return Cr(a.chunks[0])}}return Hn.reset(),Hi(Hn,n,r,t),Hn.toBytes(!0)}function Gn(e,r){return r=Object.assign({},Dl,r),qn(e,Vi,r)}var Ll={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},pt=class{constructor(r,t={}){this._pos=0,this.data=r,this.options=t}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){let r=this.data[this._pos],t=de[r];if(t===void 0){let n=y[r];if(!n)throw new Error(`${w} no decoder for major type ${r>>>5} (byte 0x${r.toString(16).padStart(2,"0")})`);let o=r&31;t=n(this.data,this._pos,o,this.options)}return this._pos+=t.encodedLength,t}},kr=Symbol.for("DONE"),mt=Symbol.for("BREAK");function Ol(e,r,t){let n=[];for(let o=0;o<e.value;o++){let s=rr(r,t);if(s===mt){if(e.value===1/0)break;throw new Error(`${w} got unexpected break to lengthed array`)}if(s===kr)throw new Error(`${w} found array but not enough entries (got ${o}, expected ${e.value})`);n[o]=s}return n}function Fl(e,r,t){let n=t.useMaps===!0,o=n?void 0:{},s=n?new Map:void 0;for(let i=0;i<e.value;i++){let a=rr(r,t);if(a===mt){if(e.value===1/0)break;throw new Error(`${w} got unexpected break to lengthed map`)}if(a===kr)throw new Error(`${w} found map but not enough entries (got ${i} [no key], expected ${e.value})`);if(n!==!0&&typeof a!="string")throw new Error(`${w} non-string keys not supported (got ${typeof a})`);if(t.rejectDuplicateMapKeys===!0&&(n&&s.has(a)||!n&&a in o))throw new Error(`${w} found repeat map key "${a}"`);let f=rr(r,t);if(f===kr)throw new Error(`${w} found map but not enough entries (got ${i} [no value], expected ${e.value})`);n?s.set(a,f):o[a]=f}return n?s:o}function rr(e,r){if(e.done())return kr;let t=e.next();if(t.type===c.break)return mt;if(t.type.terminal)return t.value;if(t.type===c.array)return Ol(t,e,r);if(t.type===c.map)return Fl(t,e,r);if(t.type===c.tag){if(r.tags&&typeof r.tags[t.value]=="function"){let n=rr(e,r);return r.tags[t.value](n)}throw new Error(`${w} tag not supported (${t.value})`)}throw new Error("unsupported")}function Wn(e,r){if(!(e instanceof Uint8Array))throw new Error(`${w} data to decode must be a Uint8Array`);r=Object.assign({},Ll,r);let t=r.tokenizer||new pt(e,r),n=rr(t,r);if(n===kr)throw new Error(`${w} did not find any content to decode`);if(n===mt)throw new Error(`${w} got unexpected break`);return[n,e.subarray(t.pos())]}function Nr(e,r){let[t,n]=Wn(e,r);if(n.length>0)throw new Error(`${w} too many terminals, data makes no sense`);return t}var qi=42;function Gi(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}function zl(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;let r=m.asCID(e);if(!r)return null;let t=new Uint8Array(r.bytes.byteLength+1);return t.set(r.bytes,1),[new l(c.tag,qi),new l(c.bytes,t)]}function Ml(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function Vl(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}var Jn={float64:!0,typeEncoders:{Object:zl,undefined:Ml,number:Vl}},Hl={...Jn,typeEncoders:{...Jn.typeEncoders}};function ql(e){if(e[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return m.decode(e.subarray(1))}var ht={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};ht.tags[qi]=ql;var Gl={...ht,tags:ht.tags.slice()},Wl="dag-cbor",Jl=113,Kn=e=>Gn(e,Jn),Xn=e=>Nr(Gi(e),ht);var to={};j(to,{code:()=>sp,decode:()=>Ji,encode:()=>Wi,format:()=>ip,name:()=>op,parse:()=>cp,stringify:()=>ip});var Qn=class extends Array{constructor(){super(),this.inRecursive=[]}prefix(r){let t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===c.array&&(t.elements++,t.elements!==1&&r.push([44])),t.type===c.map&&(t.elements++,t.elements!==1&&(t.elements%2===1?r.push([44]):r.push([58]))))}[c.uint.major](r,t){this.prefix(r);let n=String(t.value),o=[];for(let s=0;s<n.length;s++)o[s]=n.charCodeAt(s);r.push(o)}[c.negint.major](r,t){this[c.uint.major](r,t)}[c.bytes.major](r,t){throw new Error(`${xe} unsupported type: Uint8Array`)}[c.string.major](r,t){this.prefix(r);let n=nt(JSON.stringify(t.value));r.push(n.length>32?Cr(n):n)}[c.array.major](r,t){this.prefix(r),this.inRecursive.push({type:c.array,elements:0}),r.push([91])}[c.map.major](r,t){this.prefix(r),this.inRecursive.push({type:c.map,elements:0}),r.push([123])}[c.tag.major](r,t){}[c.float.major](r,t){if(t.type.name==="break"){let i=this.inRecursive.pop();if(i){if(i.type===c.array)r.push([93]);else if(i.type===c.map)r.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(t.value===void 0)throw new Error(`${xe} unsupported type: undefined`);if(this.prefix(r),t.type.name==="true"){r.push([116,114,117,101]);return}else if(t.type.name==="false"){r.push([102,97,108,115,101]);return}else if(t.type.name==="null"){r.push([110,117,108,108]);return}let n=String(t.value),o=[],s=!1;for(let i=0;i<n.length;i++)o[i]=n.charCodeAt(i),!s&&(o[i]===46||o[i]===101||o[i]===69)&&(s=!0);s||(o.push(46),o.push(48)),r.push(o)}};function Kl(e,r){if(Array.isArray(e[0])||Array.isArray(r[0]))throw new Error(`${xe} complex map keys are not supported`);let t=e[0],n=r[0];if(t.type!==c.string||n.type!==c.string)throw new Error(`${xe} non-string map keys are not supported`);if(t<n)return-1;if(t>n)return 1;throw new Error(`${xe} unexpected duplicate map keys, this is not supported`)}var Xl={addBreakTokens:!0,mapSorter:Kl};function Yn(e,r){return r=Object.assign({},Xl,r),qn(e,new Qn,r)}var tr=class{constructor(r,t={}){this._pos=0,this.data=r,this.options=t,this.modeStack=["value"],this.lastToken=""}pos(){return this._pos}done(){return this._pos>=this.data.length}ch(){return this.data[this._pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let r=this.ch();for(;r===32||r===9||r===13||r===10;)r=this.data[++this._pos]}expect(r){if(this.data.length-this._pos<r.length)throw new Error(`${w} unexpected end of input at position ${this._pos}`);for(let t=0;t<r.length;t++)if(this.data[this._pos++]!==r[t])throw new Error(`${w} unexpected token at position ${this._pos}, expected to find '${String.fromCharCode(...r)}'`)}parseNumber(){let r=this._pos,t=!1,n=!1,o=a=>{for(;!this.done();){let f=this.ch();if(a.includes(f))this._pos++;else break}};if(this.ch()===45&&(t=!0,this._pos++),this.ch()===48)if(this._pos++,this.ch()===46)this._pos++,n=!0;else return new l(c.uint,0,this._pos-r);if(o([48,49,50,51,52,53,54,55,56,57]),t&&this._pos===r+1)throw new Error(`${w} unexpected token at position ${this._pos}`);if(!this.done()&&this.ch()===46){if(n)throw new Error(`${w} unexpected token at position ${this._pos}`);n=!0,this._pos++,o([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(n=!0,this._pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this._pos++,o([48,49,50,51,52,53,54,55,56,57]));let s=String.fromCharCode.apply(null,this.data.subarray(r,this._pos)),i=parseFloat(s);return n?new l(c.float,i,this._pos-r):this.options.allowBigInt!==!0||Number.isSafeInteger(i)?new l(i>=0?c.uint:c.negint,i,this._pos-r):new l(i>=0?c.uint:c.negint,BigInt(s),this._pos-r)}parseString(){if(this.ch()!==34)throw new Error(`${w} unexpected character at position ${this._pos}; this shouldn't happen`);this._pos++;for(let s=this._pos,i=0;s<this.data.length&&i<65536;s++,i++){let a=this.data[s];if(a===92||a<32||a>=128)break;if(a===34){let f=String.fromCharCode.apply(null,this.data.subarray(this._pos,s));return this._pos=s+1,new l(c.string,f,i)}}let r=this._pos,t=[],n=()=>{if(this._pos+4>=this.data.length)throw new Error(`${w} unexpected end of unicode escape sequence at position ${this._pos}`);let s=0;for(let i=0;i<4;i++){let a=this.ch();if(a>=48&&a<=57)a-=48;else if(a>=97&&a<=102)a=a-97+10;else if(a>=65&&a<=70)a=a-65+10;else throw new Error(`${w} unexpected unicode escape character at position ${this._pos}`);s=s*16+a,this._pos++}return s},o=()=>{let s=this.ch(),i=null,a=s>239?4:s>223?3:s>191?2:1;if(this._pos+a>this.data.length)throw new Error(`${w} unexpected unicode sequence at position ${this._pos}`);let f,h,d,p;switch(a){case 1:s<128&&(i=s);break;case 2:f=this.data[this._pos+1],(f&192)===128&&(p=(s&31)<<6|f&63,p>127&&(i=p));break;case 3:f=this.data[this._pos+1],h=this.data[this._pos+2],(f&192)===128&&(h&192)===128&&(p=(s&15)<<12|(f&63)<<6|h&63,p>2047&&(p<55296||p>57343)&&(i=p));break;case 4:f=this.data[this._pos+1],h=this.data[this._pos+2],d=this.data[this._pos+3],(f&192)===128&&(h&192)===128&&(d&192)===128&&(p=(s&15)<<18|(f&63)<<12|(h&63)<<6|d&63,p>65535&&p<1114112&&(i=p))}i===null?(i=65533,a=1):i>65535&&(i-=65536,t.push(i>>>10&1023|55296),i=56320|i&1023),t.push(i),this._pos+=a};for(;!this.done();){let s=this.ch(),i;switch(s){case 92:if(this._pos++,this.done())throw new Error(`${w} unexpected string termination at position ${this._pos}`);switch(i=this.ch(),this._pos++,i){case 34:case 39:case 92:case 47:t.push(i);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(n());break;default:throw new Error(`${w} unexpected string escape character at position ${this._pos}`)}break;case 34:return this._pos++,new l(c.string,Fn(t),this._pos-r);default:if(s<32)throw new Error(`${w} invalid control character at position ${this._pos}`);s<128?(t.push(s),this._pos++):o()}}throw new Error(`${w} unexpected end of string at position ${this._pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this._pos++,new l(c.map,1/0,1);case 91:return this.modeStack.push("array-start"),this._pos++,new l(c.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new l(c.null,null,4);case 102:return this.expect([102,97,108,115,101]),new l(c.false,!1,5);case 116:return this.expect([116,114,117,101]),new l(c.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${w} unexpected character at position ${this._pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this._pos++,this.skipWhitespace(),new l(c.break,void 0,1);if(this.ch()!==44)throw new Error(`${w} unexpected character at position ${this._pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this._pos++,this.skipWhitespace(),new l(c.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this._pos++,this.skipWhitespace(),new l(c.break,void 0,1);if(this.ch()!==44)throw new Error(`${w} unexpected character at position ${this._pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this._pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this._pos++,this.skipWhitespace(),new l(c.break,void 0,1);let r=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${w} unexpected character at position ${this._pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("obj-value"),r}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${w} unexpected parse state at position ${this._pos}; this shouldn't happen`)}}};function Zn(e,r){return r=Object.assign({tokenizer:new tr(e,r)},r),Nr(e,r)}function Yl(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}function Zl(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;let r=m.asCID(e);if(!r)return null;let t=r.toString();return[new l(c.map,1/0,1),new l(c.string,"/",1),new l(c.string,t,t.length),new l(c.break,void 0,1)]}function gt(e){let r=qe.encode(e).slice(1);return[new l(c.map,1/0,1),new l(c.string,"/",1),new l(c.map,1/0,1),new l(c.string,"bytes",5),new l(c.string,r,r.length),new l(c.break,void 0,1),new l(c.break,void 0,1)]}function le(e){return gt(new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function ep(e){return gt(new Uint8Array(e))}function rp(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function tp(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}var np={typeEncoders:{Object:Zl,Buffer:gt,Uint8Array:gt,Int8Array:le,Uint16Array:le,Int16Array:le,Uint32Array:le,Int32Array:le,Float32Array:le,Float64Array:le,Uint8ClampedArray:le,BigInt64Array:le,BigUint64Array:le,DataView:le,ArrayBuffer:ep,undefined:rp,number:tp}},eo=class extends tr{constructor(r,t){super(r,t),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){let r=this._next();if(r.type===c.map){let t=this._next();if(t.type===c.string&&t.value==="/"){let n=this._next();if(n.type===c.string){if(this._next().type!==c.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(n),new l(c.tag,42,0)}if(n.type===c.map){let o=this._next();if(o.type===c.string&&o.value==="bytes"){let s=this._next();if(s.type===c.string){for(let a=0;a<2;a++)if(this._next().type!==c.break)throw new Error("Invalid encoded Bytes form");let i=qe.decode(`m${s.value}`);return new l(c.bytes,i,s.value.length)}this.tokenBuffer.push(s)}this.tokenBuffer.push(o)}this.tokenBuffer.push(n)}this.tokenBuffer.push(t)}return r}},ro={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};ro.tags[42]=m.parse;var op="dag-json",sp=297,Wi=e=>Yn(e,np),Ji=e=>{let r=Yl(e),t=Object.assign(ro,{tokenizer:new eo(r,ro)});return Zn(r,t)},ip=e=>ap.decode(Wi(e));var ap=new TextDecoder,cp=e=>Ji(up.encode(e)),up=new TextEncoder;var ao={};j(ao,{code:()=>Ep,createLink:()=>oa,createNode:()=>na,decode:()=>Pp,encode:()=>Sp,name:()=>bp,prepare:()=>so,validate:()=>io});var fp=new TextDecoder;function no(e,r){let t=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(r>=e.length)throw new Error("protobuf: unexpected end of data");let o=e[r++];if(t+=n<28?(o&127)<<n:(o&127)*2**n,o<128)break}return[t,r]}function wt(e,r){let t;[t,r]=no(e,r);let n=r+t;if(t<0||n<0)throw new Error("protobuf: invalid length");if(n>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(r,n),n]}function Ki(e,r){let t;return[t,r]=no(e,r),[t&7,t>>3,r]}function dp(e){let r={},t=e.length,n=0;for(;n<t;){let o,s;if([o,s,n]=Ki(e,n),s===1){if(r.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(o!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Hash`);if(r.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(r.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[r.Hash,n]=wt(e,n)}else if(s===2){if(r.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(o!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Name`);if(r.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let i;[i,n]=wt(e,n),r.Name=fp.decode(i)}else if(s===3){if(r.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(o!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Tsize`);[r.Tsize,n]=no(e,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${s}`)}if(n>t)throw new Error("protobuf: (PBLink) unexpected end of data");return r}function Xi(e){let r=e.length,t=0,n,o=!1,s;for(;t<r;){let a,f;if([a,f,t]=Ki(e,t),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(f===1){if(s)throw new Error("protobuf: (PBNode) duplicate Data section");[s,t]=wt(e,t),n&&(o=!0)}else if(f===2){if(o)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let h;[h,t]=wt(e,t),n.push(dp(h))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${f}`)}if(t>r)throw new Error("protobuf: (PBNode) unexpected end of data");let i={};return s&&(i.Data=s),i.Links=n||[],i}var Yi=new TextEncoder,Qi=2**32,lp=2**31;function pp(e,r){let t=r.length;if(typeof e.Tsize=="number"){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");t=Br(r,t,e.Tsize)-1,r[t]=24}if(typeof e.Name=="string"){let n=Yi.encode(e.Name);t-=n.length,r.set(n,t),t=Br(r,t,n.length)-1,r[t]=18}return e.Hash&&(t-=e.Hash.length,r.set(e.Hash,t),t=Br(r,t,e.Hash.length)-1,r[t]=10),r.length-t}function Zi(e){let r=hp(e),t=new Uint8Array(r),n=r;if(e.Data&&(n-=e.Data.length,t.set(e.Data,n),n=Br(t,n,e.Data.length)-1,t[n]=10),e.Links)for(let o=e.Links.length-1;o>=0;o--){let s=pp(e.Links[o],t.subarray(0,n));n-=s,n=Br(t,n,s)-1,t[n]=18}return t}function mp(e){let r=0;if(e.Hash){let t=e.Hash.length;r+=1+t+nr(t)}if(typeof e.Name=="string"){let t=Yi.encode(e.Name).length;r+=1+t+nr(t)}return typeof e.Tsize=="number"&&(r+=1+nr(e.Tsize)),r}function hp(e){let r=0;if(e.Data){let t=e.Data.length;r+=1+t+nr(t)}if(e.Links)for(let t of e.Links){let n=mp(t);r+=1+n+nr(n)}return r}function Br(e,r,t){r-=nr(t);let n=r;for(;t>=lp;)e[r++]=t&127|128,t/=128;for(;t>=128;)e[r++]=t&127|128,t>>>=7;return e[r]=t,n}function nr(e){return e%2===0&&e++,Math.floor((yp(e)+6)/7)}function yp(e){let r=0;return e>=Qi&&(e=Math.floor(e/Qi),r=32),e>=65536&&(e>>>=16,r+=16),e>=256&&(e>>>=8,r+=8),r+gp[e]}var gp=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8];var wp=["Data","Links"],xp=["Hash","Name","Tsize"],oo=new TextEncoder;function ra(e,r){if(e===r)return 0;let t=e.Name?oo.encode(e.Name):[],n=r.Name?oo.encode(r.Name):[],o=t.length,s=n.length;for(let i=0,a=Math.min(o,s);i<a;++i)if(t[i]!==n[i]){o=t[i],s=n[i];break}return o<s?-1:s<o?1:0}function ea(e,r){return!Object.keys(e).some(t=>!r.includes(t))}function ta(e){if(typeof e.asCID=="object"){let t=m.asCID(e);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if(typeof e!="object"||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");let r={};if(e.Hash){let t=m.asCID(e.Hash);try{t||(typeof e.Hash=="string"?t=m.parse(e.Hash):e.Hash instanceof Uint8Array&&(t=m.decode(e.Hash)))}catch(n){throw new TypeError(`Invalid DAG-PB form: ${n.message}`)}t&&(r.Hash=t)}if(!r.Hash)throw new TypeError("Invalid DAG-PB form");return typeof e.Name=="string"&&(r.Name=e.Name),typeof e.Tsize=="number"&&(r.Tsize=e.Tsize),r}function so(e){if((e instanceof Uint8Array||typeof e=="string")&&(e={Data:e}),typeof e!="object"||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");let r={};if(e.Data!==void 0)if(typeof e.Data=="string")r.Data=oo.encode(e.Data);else if(e.Data instanceof Uint8Array)r.Data=e.Data;else throw new TypeError("Invalid DAG-PB form");if(e.Links!==void 0)if(Array.isArray(e.Links))r.Links=e.Links.map(ta),r.Links.sort(ra);else throw new TypeError("Invalid DAG-PB form");else r.Links=[];return r}function io(e){if(!e||typeof e!="object"||Array.isArray(e)||e instanceof Uint8Array||e["/"]&&e["/"]===e.bytes)throw new TypeError("Invalid DAG-PB form");if(!ea(e,wp))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(e.Data!==void 0&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let r=0;r<e.Links.length;r++){let t=e.Links[r];if(!t||typeof t!="object"||Array.isArray(t)||t instanceof Uint8Array||t["/"]&&t["/"]===t.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!ea(t,xp))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(t.Hash===void 0)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(t.Hash==null||!t.Hash["/"]||t.Hash["/"]!==t.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(t.Name!==void 0&&typeof t.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(t.Tsize!==void 0){if(typeof t.Tsize!="number"||t.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(t.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(r>0&&ra(t,e.Links[r-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function na(e,r=[]){return so({Data:e,Links:r})}function oa(e,r,t){return ta({Hash:t,Name:e,Tsize:r})}function sa(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}var bp="dag-pb",Ep=112;function Sp(e){io(e);let r={};return e.Links&&(r.Links=e.Links.map(t=>{let n={};return t.Hash&&(n.Hash=t.Hash.bytes),t.Name!==void 0&&(n.Name=t.Name),t.Tsize!==void 0&&(n.Tsize=t.Tsize),n})),e.Data&&(r.Data=e.Data),Zi(r)}function Pp(e){let r=sa(e),t=Xi(r),n={};return t.Data&&(n.Data=t.Data),t.Links&&(n.Links=t.Links.map(o=>{let s={};try{s.Hash=m.decode(o.Hash)}catch{}if(!s.Hash)throw new Error("Invalid Hash field found in link, expected CID");return o.Name!==void 0&&(s.Name=o.Name),o.Tsize!==void 0&&(s.Tsize=o.Tsize),s})),n}var wo={};j(wo,{code:()=>cm,decode:()=>lm,encode:()=>dm,name:()=>am,toGeneral:()=>Ua});var Nx=new Uint8Array(0);function ia(e,r){if(e===r)return!0;if(e.byteLength!==r.byteLength)return!1;for(let t=0;t<e.byteLength;t++)if(e[t]!==r[t])return!1;return!0}function or(e){if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function Ap(e,r){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var o=0;o<e.length;o++){var s=e.charAt(o),i=s.charCodeAt(0);if(t[i]!==255)throw new TypeError(s+" is ambiguous");t[i]=o}var a=e.length,f=e.charAt(0),h=Math.log(a)/Math.log(256),d=Math.log(256)/Math.log(a);function p(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var x=0,C=0,P=0,N=g.length;P!==N&&g[P]===0;)P++,x++;for(var _=(N-P)*d+1>>>0,I=new Uint8Array(_);P!==N;){for(var R=g[P],O=0,B=_-1;(R!==0||O<C)&&B!==-1;B--,O++)R+=256*I[B]>>>0,I[B]=R%a>>>0,R=R/a>>>0;if(R!==0)throw new Error("Non-zero carry");C=O,P++}for(var $=_-C;$!==_&&I[$]===0;)$++;for(var ie=f.repeat(x);$<_;++$)ie+=e.charAt(I[$]);return ie}function b(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var x=0;if(g[x]!==" "){for(var C=0,P=0;g[x]===f;)C++,x++;for(var N=(g.length-x)*h+1>>>0,_=new Uint8Array(N);g[x];){var I=t[g.charCodeAt(x)];if(I===255)return;for(var R=0,O=N-1;(I!==0||R<P)&&O!==-1;O--,R++)I+=a*_[O]>>>0,_[O]=I%256>>>0,I=I/256>>>0;if(I!==0)throw new Error("Non-zero carry");P=R,x++}if(g[x]!==" "){for(var B=N-P;B!==N&&_[B]===0;)B++;for(var $=new Uint8Array(C+(N-B)),ie=C;B!==N;)$[ie++]=_[B++];return $}}}function T(g){var x=b(g);if(x)return x;throw new Error(`Non-${r} character`)}return{encode:p,decodeUnsafe:b,decode:T}}var Cp=Ap,vp=Cp,aa=vp;var co=class{name;prefix;baseEncode;constructor(r,t,n){this.name=r,this.prefix=t,this.baseEncode=n}encode(r){if(r instanceof Uint8Array)return`${this.prefix}${this.baseEncode(r)}`;throw Error("Unknown type, must be binary type")}},uo=class{name;prefix;baseDecode;prefixCodePoint;constructor(r,t,n){if(this.name=r,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(r){if(typeof r=="string"){if(r.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(r)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(r.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(r){return ca(this,r)}},fo=class{decoders;constructor(r){this.decoders=r}or(r){return ca(this,r)}decode(r){let t=r[0],n=this.decoders[t];if(n!=null)return n.decode(r);throw RangeError(`Unable to decode multibase string ${JSON.stringify(r)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function ca(e,r){return new fo({...e.decoders??{[e.prefix]:e},...r.decoders??{[r.prefix]:r}})}var lo=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(r,t,n,o){this.name=r,this.prefix=t,this.baseEncode=n,this.baseDecode=o,this.encoder=new co(r,t,n),this.decoder=new uo(r,t,o)}encode(r){return this.encoder.encode(r)}decode(r){return this.decoder.decode(r)}};function ua({name:e,prefix:r,encode:t,decode:n}){return new lo(e,r,t,n)}function po({name:e,prefix:r,alphabet:t}){let{encode:n,decode:o}=aa(t,e);return ua({prefix:r,name:e,encode:n,decode:s=>or(o(s))})}function Ip(e,r,t,n){let o={};for(let d=0;d<r.length;++d)o[r[d]]=d;let s=e.length;for(;e[s-1]==="=";)--s;let i=new Uint8Array(s*t/8|0),a=0,f=0,h=0;for(let d=0;d<s;++d){let p=o[e[d]];if(p===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<t|p,a+=t,a>=8&&(a-=8,i[h++]=255&f>>a)}if(a>=t||255&f<<8-a)throw new SyntaxError("Unexpected end of data");return i}function Up(e,r,t){let n=r[r.length-1]==="=",o=(1<<t)-1,s="",i=0,a=0;for(let f=0;f<e.length;++f)for(a=a<<8|e[f],i+=8;i>t;)i-=t,s+=r[o&a>>i];if(i!==0&&(s+=r[o&a<<t-i]),n)for(;s.length*t&7;)s+="=";return s}function W({name:e,prefix:r,bitsPerChar:t,alphabet:n}){return ua({prefix:r,name:e,encode(o){return Up(o,n,t)},decode(o){return Ip(o,n,t,e)}})}var Ox=W({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Fx=W({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),mo=W({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),jx=W({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function pe(e){return mo.encode(e).slice(1)}function ne(e){return mo.decode(`u${e}`)}var Dr=W({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),qx=W({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Gx=W({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Wx=W({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Jx=W({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Kx=W({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Xx=W({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Qx=W({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Yx=W({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ee=po({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),r0=po({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Tp=la,fa=128,kp=127,Np=~kp,Bp=Math.pow(2,31);function la(e,r,t){r=r||[],t=t||0;for(var n=t;e>=Bp;)r[t++]=e&255|fa,e/=128;for(;e&Np;)r[t++]=e&255|fa,e>>>=7;return r[t]=e|0,la.bytes=t-n+1,r}var Dp=ho,_p=128,da=127;function ho(e,n){var t=0,n=n||0,o=0,s=n,i,a=e.length;do{if(s>=a)throw ho.bytes=0,new RangeError("Could not decode varint");i=e[s++],t+=o<28?(i&da)<<o:(i&da)*Math.pow(2,o),o+=7}while(i>=_p);return ho.bytes=s-n,t}var Rp=Math.pow(2,7),$p=Math.pow(2,14),Lp=Math.pow(2,21),Op=Math.pow(2,28),Fp=Math.pow(2,35),jp=Math.pow(2,42),zp=Math.pow(2,49),Mp=Math.pow(2,56),Vp=Math.pow(2,63),Hp=function(e){return e<Rp?1:e<$p?2:e<Lp?3:e<Op?4:e<Fp?5:e<jp?6:e<zp?7:e<Mp?8:e<Vp?9:10},qp={encode:Tp,decode:Dp,encodingLength:Hp},Gp=qp,_r=Gp;function Rr(e,r=0){return[_r.decode(e,r),_r.decode.bytes]}function sr(e,r,t=0){return _r.encode(e,r,t),r}function ir(e){return _r.encodingLength(e)}function ma(e,r){let t=r.byteLength,n=ir(e),o=n+ir(t),s=new Uint8Array(o+t);return sr(e,s,0),sr(t,s,n),s.set(r,o),new ar(e,t,r,s)}function ha(e){let r=or(e),[t,n]=Rr(r),[o,s]=Rr(r.subarray(n)),i=r.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new ar(t,o,i,r)}function ya(e,r){if(e===r)return!0;{let t=r;return e.code===t.code&&e.size===t.size&&t.bytes instanceof Uint8Array&&ia(e.bytes,t.bytes)}}var ar=class{code;size;digest;bytes;constructor(r,t,n,o){this.code=r,this.size=t,this.digest=n,this.bytes=o}};function ga(e,r){let{bytes:t,version:n}=e;switch(n){case 0:return Kp(t,yo(e),r??Ee.encoder);default:return Xp(t,yo(e),r??Dr.encoder)}}var wa=new WeakMap;function yo(e){let r=wa.get(e);if(r==null){let t=new Map;return wa.set(e,t),t}return r}var cr=class e{code;version;multihash;bytes;"/";constructor(r,t,n,o){this.code=t,this.version=r,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:r,multihash:t}=this;if(r!==$r)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Qp)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return e.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:r,digest:t}=this.multihash,n=ma(r,t);return e.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(r){return e.equals(this,r)}static equals(r,t){let n=t;return n!=null&&r.code===n.code&&r.version===n.version&&ya(r.multihash,n.multihash)}toString(r){return ga(this,r)}toJSON(){return{"/":ga(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(r){if(r==null)return null;let t=r;if(t instanceof e)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){let{version:n,code:o,multihash:s,bytes:i}=t;return new e(n,o,s,i??xa(n,o,s.bytes))}else if(t[Yp]===!0){let{version:n,multihash:o,code:s}=t,i=ha(o);return e.create(n,s,i)}else return null}static create(r,t,n){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(r){case 0:{if(t!==$r)throw new Error(`Version 0 CID must use dag-pb (code: ${$r}) block encoding`);return new e(r,t,n,n.bytes)}case 1:{let o=xa(r,t,n.bytes);return new e(r,t,n,o)}default:throw new Error("Invalid version")}}static createV0(r){return e.create(0,$r,r)}static createV1(r,t){return e.create(1,r,t)}static decode(r){let[t,n]=e.decodeFirst(r);if(n.length!==0)throw new Error("Incorrect length");return t}static decodeFirst(r){let t=e.inspectBytes(r),n=t.size-t.multihashSize,o=or(r.subarray(n,n+t.multihashSize));if(o.byteLength!==t.multihashSize)throw new Error("Incorrect length");let s=o.subarray(t.multihashSize-t.digestSize),i=new ar(t.multihashCode,t.digestSize,s,o);return[t.version===0?e.createV0(i):e.createV1(t.codec,i),r.subarray(t.size)]}static inspectBytes(r){let t=0,n=()=>{let[p,b]=Rr(r.subarray(t));return t+=b,p},o=n(),s=$r;if(o===18?(o=0,t=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=t,a=n(),f=n(),h=t+f,d=h-i;return{version:o,codec:s,multihashCode:a,digestSize:f,multihashSize:d,size:h}}static parse(r,t){let[n,o]=Jp(r,t),s=e.decode(o);if(s.version===0&&r[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return yo(s).set(n,r),s}};function Jp(e,r){switch(e[0]){case"Q":{let t=r??Ee;return[Ee.prefix,t.decode(`${Ee.prefix}${e}`)]}case Ee.prefix:{let t=r??Ee;return[Ee.prefix,t.decode(e)]}case Dr.prefix:{let t=r??Dr;return[Dr.prefix,t.decode(e)]}default:{if(r==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],r.decode(e)]}}}function Kp(e,r,t){let{prefix:n}=t;if(n!==Ee.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let o=r.get(n);if(o==null){let s=t.encode(e).slice(1);return r.set(n,s),s}else return o}function Xp(e,r,t){let{prefix:n}=t,o=r.get(n);if(o==null){let s=t.encode(e);return r.set(n,s),s}else return o}var $r=112,Qp=18;function xa(e,r,t){let n=ir(e),o=n+ir(r),s=new Uint8Array(o+t.byteLength);return sr(e,s,0),sr(r,s,n),s.set(t,o),s}var Yp=Symbol.for("@ipld/js-cid/CID");function ba(e){let[r,t,n]=e;return{payload:t,signatures:[{protected:r,signature:n}],link:cr.decode(ne(t))}}function Zp(e){let r={signature:ne(e.signature)};return e.header&&(r.header=e.header),e.protected&&(r.protected=ne(e.protected)),r}function Ea(e){return{payload:ne(e.payload),signatures:e.signatures.map(Zp)}}function em(e){let r={signature:pe(e.signature)};return e.header&&(r.header=e.header),e.protected&&(r.protected=pe(e.protected)),r}function Sa(e){let r={payload:pe(e.payload),signatures:e.signatures.map(em)};try{return r.pld=go(tm(e.payload)),r}catch{try{return r.link=cr.decode(new Uint8Array(e.payload)),r}catch{throw new Error("Invalid payload, must be either JSON or CID")}}}function go(e){if(typeof e=="string"){if(e.startsWith("ipfs://"))return cr.parse(e.slice(7))}else{if(Array.isArray(e))return e.map(go);if(rm(e)){let r={};for(let t in e)r[t]=go(e[t]);return r}}return e}function rm(e){return typeof e=="object"&&e!==null}function tm(e){return JSON.parse(new TextDecoder().decode(e))}function Pa(e){let[r,t,n,o,s]=e,i={ciphertext:o,iv:n,protected:r,tag:s};return t&&(i.recipients=[{encrypted_key:t}]),i}function om(e){let r={};return e.encrypted_key&&(r.encrypted_key=ne(e.encrypted_key)),e.header&&(r.header=e.header),r}function Aa(e){let r={ciphertext:ne(e.ciphertext),protected:ne(e.protected),iv:ne(e.iv),tag:ne(e.tag)};return e.aad&&(r.aad=ne(e.aad)),e.recipients&&(r.recipients=e.recipients.map(om)),e.unprotected&&(r.unprotected=e.unprotected),r}function sm(e){let r={};return e.encrypted_key&&(r.encrypted_key=pe(e.encrypted_key)),e.header&&(r.header=e.header),r}function Ca(e){let r={ciphertext:pe(e.ciphertext),protected:pe(e.protected),iv:pe(e.iv),tag:pe(e.tag)};return e.aad&&(r.aad=pe(e.aad)),e.recipients&&(r.recipients=e.recipients.map(sm)),e.unprotected&&(r.unprotected=e.unprotected),r}var am="dag-jose",cm=133;function va(e){return"payload"in e&&typeof e.payload=="string"&&"signatures"in e&&Array.isArray(e.signatures)}function um(e){return"payload"in e&&e.payload instanceof Uint8Array&&"signatures"in e&&Array.isArray(e.signatures)}function fm(e){return"ciphertext"in e&&e.ciphertext instanceof Uint8Array&&"iv"in e&&e.iv instanceof Uint8Array&&"protected"in e&&e.protected instanceof Uint8Array&&"tag"in e&&e.tag instanceof Uint8Array}function Ia(e){return"ciphertext"in e&&typeof e.ciphertext=="string"&&"iv"in e&&typeof e.iv=="string"&&"protected"in e&&typeof e.protected=="string"&&"tag"in e&&typeof e.tag=="string"}function Ua(e){if(typeof e=="string"){let r=e.split(".");if(r.length===3)return ba(r);if(r.length===5)return Pa(r);throw new Error("Not a valid JOSE string")}if(va(e)||Ia(e))return e;throw new Error("Not a valid unencoded JOSE object")}function dm(e){typeof e=="string"&&(e=Ua(e));let r;if(va(e))r=Ea(e);else if(Ia(e))r=Aa(e);else throw new Error("Not a valid JOSE object");return new Uint8Array(Kn(r))}function lm(e){let r;try{r=Xn(e)}catch{throw new Error("Not a valid DAG-JOSE object")}if(um(r))return Sa(r);if(fm(r))return Ca(r);throw new Error("Not a valid DAG-JOSE object")}function V(e){let r=new globalThis.AbortController;function t(){r.abort();for(let s of e)s?.removeEventListener!=null&&s.removeEventListener("abort",t)}for(let s of e){if(s?.aborted===!0){t();break}s?.addEventListener!=null&&s.addEventListener("abort",t)}function n(){for(let s of e)s?.removeEventListener!=null&&s.removeEventListener("abort",t)}let o=r.signal;return o.clear=n,o}var Ta="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var ka=(e=21)=>{let r="",t=crypto.getRandomValues(new Uint8Array(e));for(;e--;)r+=Ta[t[e]&63];return r};var Da=De(Ba(),1),_a=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,xo=(0,Da.default)(),ur=_a&&!xo;var Ra=xo&&_a,$a=typeof globalThis.process<"u"&&typeof globalThis.process.release<"u"&&globalThis.process.release.name==="node"&&!xo,fr=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,x0=typeof globalThis.process<"u"&&typeof globalThis.process.env<"u"&&globalThis.process.env["NODE"+"_"+"ENV"]==="test",b0=typeof navigator<"u"&&navigator.product==="ReactNative";async function*Se(e,r={}){let t=e.getReader();try{for(;;){let n=await t.read();if(n.done)return;yield n.value}}finally{r.preventCancel!==!0&&await t.cancel(),t.releaseLock()}}var Fr=De(Lr(),1);function hm(e){let[r,t]=e[Symbol.asyncIterator]!=null?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>r.next(),push:o=>{n.push(o)},next:()=>n.length>0?{done:!1,value:n.shift()}:r.next(),[t](){return this}}}var Te=hm;function ym(e){return e[Symbol.asyncIterator]!=null}function gm(e,r){let t=0;if(ym(e))return async function*(){for await(let f of e)yield r(f,t++)}();let n=Te(e),{value:o,done:s}=n.next();if(s===!0)return function*(){}();let i=r(o,t++);if(typeof i.then=="function")return async function*(){yield await i;for await(let f of n)yield r(f,t++)}();let a=r;return function*(){yield i;for(let f of n)yield a(f,t++)}()}var bo=gm;var Eo=Symbol.for("@libp2p/peer-id");var oe=class extends Error{code;props;constructor(r,t,n){super(r),this.code=t,this.name=n?.name??"CodeError",this.props=n??{}}};function Pe(e){return ArrayBuffer.isView(e)||e instanceof ArrayBuffer}function Fe(e){return e.constructor!=null&&(e.constructor.name==="Blob"||e.constructor.name==="File")&&typeof e.stream=="function"}function Or(e){return typeof e=="object"&&(e.path!=null||e.content!=null)}function je(e){return typeof e?.getReader=="function"}function xt(e){if(e!=null)return typeof e=="string"&&(e=parseInt(e,8)),e&4095}function wm(e){return Object.prototype.hasOwnProperty.call(e,"secs")}function xm(e){return Object.prototype.hasOwnProperty.call(e,"Seconds")}function bm(e){return Array.isArray(e)}function ke(e){if(e!=null){if(wm(e)&&(e={secs:e.secs,nsecs:e.nsecs}),xm(e)&&(e={secs:BigInt(e.Seconds),nsecs:e.FractionalNanoseconds}),bm(e)&&(e={secs:BigInt(e[0]),nsecs:e[1]}),e instanceof Date){let r=e.getTime(),t=Math.floor(r/1e3);e={secs:BigInt(t),nsecs:(r-t*1e3)*1e3}}if(typeof e=="bigint"){let r=e/BigInt(1e9),t=e-r*BigInt(1e9);e={secs:r,nsecs:Number(t)}}if(Object.prototype.hasOwnProperty.call(e,"secs")){if(e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw new oe("mtime-nsecs must be within the range [0,999999999]","ERR_INVALID_MTIME_NSECS");return e}}}async function*Fa(e,r){if(typeof e=="string"||e instanceof String||Pe(e)||Fe(e)||e._readableState!=null)throw(0,Fr.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(je(e)&&(e=Se(e)),Symbol.iterator in e||Symbol.asyncIterator in e){let t=Te(e),{value:n,done:o}=await t.peek();if(o===!0){yield*[];return}if(t.push(n),Number.isInteger(n))throw(0,Fr.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(n._readableState!=null){yield*bo(t,async s=>So({content:s},r));return}if(Pe(n)){yield So({content:t},r);return}if(Or(n)||n[Symbol.iterator]||n[Symbol.asyncIterator]||je(n)||Fe(n)){yield*bo(t,async s=>So(s,r));return}}throw Or(e)?(0,Fr.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT"):(0,Fr.default)(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}async function So(e,r){let{path:t,mode:n,mtime:o,content:s}=e,i={path:t??"",mode:xt(n),mtime:ke(o)};return s!=null?i.content=await r(s):t==null&&(i.content=await r(e)),i}function Em(e){return e[Symbol.asyncIterator]!=null}function Sm(e){if(Em(e))return(async()=>{let t=[];for await(let n of e)t.push(n);return t})();let r=[];for(let t of e)r.push(t);return r}var bt=Sm;async function Et(e){if(Pe(e))return new Blob([e]);if(typeof e=="string"||e instanceof String)return new Blob([e.toString()]);if(Fe(e))return e;if(je(e)&&(e=Se(e)),Symbol.iterator in e||Symbol.asyncIterator in e){let r=Te(e),{value:t,done:n}=await r.peek();if(n===!0)return ja(r);if(r.push(t),Number.isInteger(t))return new Blob([Uint8Array.from(await bt(r))]);if(Pe(t)||typeof t=="string"||t instanceof String)return ja(r)}throw new oe(`Unexpected input: ${e}`,"ERR_UNEXPECTED_INPUT")}async function ja(e){let r=[];for await(let t of e)r.push(t);return new Blob(r)}function za(e){return Fa(e,Et,!0)}function dr(e){if(e!=null)return typeof e=="string"?e:e.toString(8).padStart(4,"0")}async function St(e,r,t={},n){let o=[],s=new FormData,i=0,a=0;for await(let{content:f,path:h,mode:d,mtime:p}of za(e)){let b="",T=f!=null?"file":"dir";i>0&&(b=`-${i}`);let g=T+b,x=[];if(d!=null&&x.push(`mode=${dr(d)}`),p!=null){let{secs:C,nsecs:P}=p;x.push(`mtime=${C}`),P!=null&&x.push(`mtime-nsecs=${P}`)}if(x.length>0&&(g=`${g}?${x.join("&")}`),f!=null){s.set(g,f,h!=null?encodeURIComponent(h):void 0);let C=a+f.size;o.push({name:h,start:a,end:C}),a=C}else if(h!=null)s.set(g,new File([""],encodeURIComponent(h),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");i++}return{total:a,parts:o,headers:t,body:s}}async function G(e,r,t={},n=`-----------------------------${ka()}`){let o=St;return Ra&&(o=St),o(e,r,t,n)}function A(e){if(e==null)return e;let r=/^[A-Z]+$/,t={};return Object.keys(e).reduce((n,o)=>(r.test(o)?n[o.toLowerCase()]=e[o]:r.test(o[0])?n[o[0].toLowerCase()+o.slice(1)]=e[o]:n[o]=e[o],n),t)}function u({arg:e,searchParams:r,hashAlg:t,mtime:n,mode:o,...s}={}){r!=null&&(s={...s,...r}),t!=null&&(s.hash=t),n!=null&&(n=ke(n),s.mtime=n.secs,s.mtimeNsecs=n.nsecs),o!=null&&(s.mode=dr(o)),isNaN(s.timeout)||(s.timeout=`${s.timeout}ms`),e==null?e=[]:Array.isArray(e)||(e=[e]);let i=new URLSearchParams(s);return e.forEach(a=>{i.append("arg",a)}),i}function Pt(e){return async function*(t,n={}){let o=new AbortController,s=V([o.signal,n.signal]);try{let{headers:i,body:a,total:f,parts:h}=await G(t,o,n.headers),[d,p]=typeof n.progress=="function"?Pm(f,n.progress,h):[void 0,void 0],b=await e.post("add",{searchParams:u({"stream-channels":!0,...n,progress:!!d}),onUploadProgress:p,signal:s,headers:i,body:a});for await(let T of b.ndjson())T=A(T),T.hash!==void 0?yield Cm(T):d?.(T.bytes??0,T.name)}finally{s.clear()}}}var Pm=(e,r,t)=>t!=null?[void 0,Am(e,t,r)]:[r,void 0],Am=(e,r,t)=>{let n=0,o=r.length;return({loaded:s,total:i})=>{let a=Math.floor(s/i*e);for(;n<o;){let{start:f,end:h,name:d}=r[n];if(a<h){t(a-f,d);break}else t(h-f,d),n+=1}}};function Cm({name:e,hash:r,size:t,mode:n,mtime:o,mtimeNsecs:s}){let i={path:e,cid:m.parse(r),size:parseInt(t)};return n!=null&&(i.mode=parseInt(n,8)),o!=null&&(i.mtime={secs:o,nsecs:s??0}),i}function vm(e){return e[Symbol.asyncIterator]!=null}function Im(e){if(vm(e))return(async()=>{let t;for await(let n of e)t=n;return t})();let r;for(let t of e)r=t;return r}var Ne=Im;var Ct=De(Lr(),1);async function*Ma(e,r){if(e==null)throw(0,Ct.default)(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");if(typeof e=="string"||e instanceof String){yield At(e.toString(),r);return}if(Pe(e)||Fe(e)){yield At(e,r);return}if(je(e)&&(e=Se(e)),Symbol.iterator in e||Symbol.asyncIterator in e){let t=Te(e),{value:n,done:o}=await t.peek();if(o===!0){yield{content:[]};return}if(t.push(n),Number.isInteger(n)||Pe(n)||typeof n=="string"||n instanceof String){yield At(t,r);return}throw(0,Ct.default)(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(Or(e)){yield At(e,r);return}throw(0,Ct.default)(new Error('Unexpected input: cannot convert "'+typeof e+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT")}async function At(e,r){let{path:t,mode:n,mtime:o,content:s}=e,i={path:t??"",mode:xt(n),mtime:ke(o)};return s!=null?i.content=await r(s):t==null&&(i.content=await r(e)),i}function Va(e){return Ma(e,Et)}function Ha(e){let r=Pt(e);return async function(n,o={}){let s=Va(n),i=r(s,o),a=await Ne(i);if(a==null)throw new Error("Invalid body");return a}}var Ga=Symbol.for("nodejs.util.inspect.custom"),qa=Object.values(he).map(e=>e.decoder).reduce((e,r)=>e.or(r),he.identity.decoder),Wa=114,Ja=36,Ka=37,jr=class{type;multihash;privateKey;publicKey;string;constructor(r){this.type=r.type,this.multihash=r.multihash,this.privateKey=r.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[Eo]=!0;toString(){return this.string==null&&(this.string=z.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return m.createV1(Wa,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(r){if(r==null)return!1;if(r instanceof Uint8Array)return Pr(this.multihash.bytes,r);if(typeof r=="string")return F(r).equals(this);if(r?.multihash?.bytes!=null)return Pr(this.multihash.bytes,r.multihash.bytes);throw new Error("not valid Id")}[Ga](){return`PeerId(${this.toString()})`}},zr=class extends jr{type="RSA";publicKey;constructor(r){super({...r,type:"RSA"}),this.publicKey=r.publicKey}},Mr=class extends jr{type="Ed25519";publicKey;constructor(r){super({...r,type:"Ed25519"}),this.publicKey=r.multihash.digest}},Vr=class extends jr{type="secp256k1";publicKey;constructor(r){super({...r,type:"secp256k1"}),this.publicKey=r.multihash.digest}},Po=2336,Ao=class{type="url";multihash;privateKey;publicKey;url;constructor(r){this.url=r.toString(),this.multihash=ve.digest(ue(this.url))}[Ga](){return`PeerId(${this.url})`}[Eo]=!0;toString(){return this.toCID().toString()}toCID(){return m.createV1(Po,this.multihash)}toBytes(){return this.toCID().bytes}equals(r){return r==null?!1:(r instanceof Uint8Array&&(r=D(r)),r.toString()===this.toString())}};function F(e,r){if(r=r??qa,e.charAt(0)==="1"||e.charAt(0)==="Q"){let t=_e(z.decode(`z${e}`));return e.startsWith("12D")?new Mr({multihash:t}):e.startsWith("16U")?new Vr({multihash:t}):new zr({multihash:t})}return Um(qa.decode(e))}function Um(e){try{let r=_e(e);if(r.code===ve.code){if(r.digest.length===Ja)return new Mr({multihash:r});if(r.digest.length===Ka)return new Vr({multihash:r})}if(r.code===Xr.code)return new zr({multihash:r})}catch{return Tm(m.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function Tm(e){if(e?.multihash==null||e.version==null||e.version===1&&e.code!==Wa&&e.code!==Po)throw new Error("Supplied PeerID CID is invalid");if(e.code===Po){let t=D(e.multihash.digest);return new Ao(new URL(t))}let r=e.multihash;if(r.code===Xr.code)return new zr({multihash:e.multihash});if(r.code===ve.code){if(r.digest.length===Ja)return new Mr({multihash:e.multihash});if(r.digest.length===Ka)return new Vr({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}function vt(e){return async function(t={}){let n=await e.post("bitswap/stat",{searchParams:u(t),signal:t.signal,headers:t.headers});return km(await n.json())}}function km(e){return{provideBufLen:e.ProvideBufLen,wantlist:(e.Wantlist??[]).map(r=>m.parse(r["/"])),peers:(e.Peers??[]).map(r=>F(r)),blocksReceived:BigInt(e.BlocksReceived),dataReceived:BigInt(e.DataReceived),blocksSent:BigInt(e.BlocksSent),dataSent:BigInt(e.DataSent),dupBlksReceived:BigInt(e.DupBlksReceived),dupDataReceived:BigInt(e.DupDataReceived)}}function Xa(e){return async function(t,n={}){return((await(await e.post("bitswap/wantlist",{signal:n.signal,searchParams:u({...n,peer:t.toString()}),headers:n.headers})).json()).Keys??[]).map(s=>m.parse(s["/"]))}}function Qa(e){return async function(t={}){return((await(await e.post("bitswap/wantlist",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()).Keys??[]).map(o=>m.parse(o["/"]))}}function Co(e){return{wantlist:Qa(e),wantlistForPeer:Xa(e),stat:vt(e)}}function It(e){return async function(t,n={}){let o=await e.post("block/get",{signal:n.signal,searchParams:u({arg:t.toString(),...n}),headers:n.headers});return new Uint8Array(await o.arrayBuffer())}}function Ya(e){return async function r(t,n={}){let o=new AbortController,s=V([o.signal,n.signal]),i;try{i=await(await e.post("block/put",{signal:s,searchParams:u(n),...await G([t],o,n.headers)})).json()}catch(a){if(n.format==="dag-pb")return await r(t,{...n,format:"protobuf"});if(n.format==="dag-cbor")return await r(t,{...n,format:"cbor"});throw a}finally{s.clear()}return m.parse(i.Key)}}function Za(e){return async function*(t,n={}){Array.isArray(t)||(t=[t]);let o=await e.post("block/rm",{signal:n.signal,searchParams:u({arg:t.map(s=>s.toString()),"stream-channels":!0,...n}),headers:n.headers});for await(let s of o.ndjson())yield Nm(s)}}function Nm(e){let r={cid:m.parse(e.Hash)};return e.Error!=null&&(r.error=new Error(e.Error)),r}function ec(e){return async function(t,n={}){let s=await(await e.post("block/stat",{signal:n.signal,searchParams:u({arg:t.toString(),...n}),headers:n.headers})).json();return{cid:m.parse(s.Key),size:s.Size}}}function vo(e){return{get:It(e),put:Ya(e),rm:Za(e),stat:ec(e)}}function rc(e){return async function(t,n={}){let o=await e.post("bootstrap/add",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers}),{Peers:s}=await o.json();return{Peers:s.map(i=>k(i))}}}function tc(e){return async function(t={}){let n=await e.post("bootstrap/list",{signal:t.signal,searchParams:u(t),headers:t.headers}),{Peers:o}=await n.json();return{Peers:o.map(s=>k(s))}}}function nc(e){return async function(t,n={}){let o=await e.post("bootstrap/rm",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers}),{Peers:s}=await o.json();return{Peers:s.map(i=>k(i))}}}function Io(e){return{add:rc(e),list:tc(e),rm:nc(e)}}function oc(e){return async function*(t,n={}){yield*(await e.post("cat",{signal:n.signal,searchParams:u({arg:t.toString(),...n}),headers:n.headers})).iterator()}}function sc(e){return async function(t={}){return(await e.post("commands",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()}}function ic(e){return async function(t={}){return await(await e.post("config/show",{signal:t.signal,searchParams:u({...t}),headers:t.headers})).json()}}function ac(e){return async function(t,n={}){if(t==null)throw new Error("key argument is required");return(await(await e.post("config",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers})).json()).Value}}function cc(e){return async function(t,n={}){let s=await(await e.post("config/profile/apply",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers})).json();return{original:s.OldCfg,updated:s.NewCfg}}}function uc(e){return{apply:cc(e)}}function fc(e){return async function(t,n={}){let o=new AbortController,s=V([o.signal,n.signal]);try{await(await e.post("config/replace",{signal:s,searchParams:u(n),...await G([ue(JSON.stringify(t))],o,n.headers)})).text()}finally{s.clear()}}}function dc(e){return async function(t,n,o={}){if(typeof t!="string")throw new Error("Invalid key type");let s={...o,...Bm(t,n)};await(await e.post("config",{signal:o.signal,searchParams:u(s),headers:o.headers})).text()}}function Bm(e,r){switch(typeof r){case"boolean":return{arg:[e,r.toString()],bool:!0};case"string":return{arg:[e,r]};default:return{arg:[e,JSON.stringify(r)],json:!0}}}function Uo(e){return{getAll:ic(e),get:ac(e),set:dc(e),replace:fc(e),profiles:uc(e)}}function lc(e){return async function*(t,n={}){yield*(await e.post("dag/export",{signal:n.signal,searchParams:u({arg:t.toString()}),headers:n.headers})).iterator()}}var mc=De(Lr(),1);function Dm(e){return e[Symbol.asyncIterator]!=null}function _m(e){if(Dm(e))return(async()=>{for await(let r of e)return r})();for(let r of e)return r}var pc=_m;var To=De(Lr(),1);async function*ko(e,r,t,n,o){let s=async h=>{let d=await t.getCodec(h.code),p=await n(h,o);return d.decode(p)},i=r.split("/").filter(Boolean),a=await s(e),f=e;for(;i.length>0;){let h=i.shift();if(h==null)throw(0,To.default)(new Error(`Could not resolve path "${r}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(a,h))a=a[h],yield{value:a,remainderPath:i.join("/")};else throw(0,To.default)(new Error(`no link named "${h}" under ${f}`),"ERR_NO_LINK");let d=m.asCID(a);d!=null&&(f=d,a=await s(a))}yield{value:a,remainderPath:""}}function hc(e,r){let t=It(e);return async function(o,s={}){if(s.path!=null){let d=s.localResolve===!0?await pc(ko(o,s.path,r,t,s)):await Ne(ko(o,s.path,r,t,s));if(d==null)throw(0,mc.default)(new Error("Not found"),"ERR_NOT_FOUND");return d}let i=await r.getCodec(o.code),a=await t(o,s);return{value:i.decode(a),remainderPath:""}}}function yc(e){return async function*(t,n={}){let o=new AbortController,s=V([o.signal,n.signal]);try{let{headers:i,body:a}=await G(t,o,n.headers),f=await e.post("dag/import",{signal:s,headers:i,body:a,searchParams:u({"pin-roots":n.pinRoots})});for await(let{Root:h}of f.ndjson())if(h!==void 0){let{Cid:{"/":d},PinErrorMsg:p}=h;yield{root:{cid:m.parse(d),pinErrorMsg:p}}}}finally{s.clear()}}}function gc(e,r){return async function(n,o={}){let s={storeCodec:"dag-cbor",hashAlg:"sha2-256",...o},i;if(s.inputCodec!=null){if(!(n instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");i=n}else i=(await r.getCodec(s.storeCodec??"dag-cbor")).encode(n),s.inputCodec=s.storeCodec;let a=new AbortController,f=V([a.signal,s.signal]);try{let d=await(await e.post("dag/put",{timeout:s.timeout,signal:f,searchParams:u(s),...await G([i],a,s.headers)})).json();return m.parse(d.Cid["/"])}finally{f.clear()}}}function wc(e){return async function(t,n={}){let s=await(await e.post("dag/resolve",{signal:n.signal,searchParams:u({arg:`${t}${n.path!=null?`/${n.path}`.replace(/\/[/]+/g,"/"):""}`,...n}),headers:n.headers})).json();return{cid:m.parse(s.Cid["/"]),remainderPath:s.RemPath}}}function No(e,r){return{export:lc(e),get:hc(e,r),import:yc(e),put:gc(e,r),resolve:wc(e)}}function se(e){if(e.Type===0)return{name:"SENDING_QUERY",type:e.Type};if(e.Type===1)return{from:F(e.ID),name:"PEER_RESPONSE",type:e.Type,messageType:0,messageName:"PUT_VALUE",closer:(e.Responses??[]).map(({ID:r,Addrs:t})=>({id:F(r),multiaddrs:t.map(n=>k(n)),protocols:[]})),providers:(e.Responses??[]).map(({ID:r,Addrs:t})=>({id:F(r),multiaddrs:t.map(n=>k(n)),protocols:[]}))};if(e.Type===2){let r={id:e.ID??F(e.ID),multiaddrs:[],protocols:[]};return e.Responses?.length>0&&(r={id:F(e.Responses[0].ID),multiaddrs:e.Responses[0].Addrs.map(t=>k(t)),protocols:[]}),{name:"FINAL_PEER",type:e.Type,peer:r}}if(e.Type===3)return{name:"QUERY_ERROR",type:e.Type,error:new Error(e.Extra)};if(e.Type===4)return{name:"PROVIDER",type:e.Type,providers:e.Responses.map(({ID:r,Addrs:t})=>({id:F(r),multiaddrs:t.map(n=>k(n)),protocols:[]}))};if(e.Type===5)return{name:"VALUE",type:e.Type,value:ue(e.Extra,"base64pad")};if(e.Type===6){let r=e.Responses.map(({ID:t})=>F(t));if(r.length===0)throw new Error("No peer found");return{name:"ADDING_PEER",type:e.Type,peer:r[0]}}if(e.Type===7)return{name:"DIALING_PEER",type:e.Type,peer:F(e.ID)};throw new Error("Unknown DHT event type")}function xc(e){return async function*(t,n={}){let o=await e.post("dht/query",{signal:n.signal,searchParams:u({arg:t.toString(),...n}),headers:n.headers});for await(let s of o.ndjson())yield se(s)}}var Bo;(function(e){e[e.SENDING_QUERY=0]="SENDING_QUERY",e[e.PEER_RESPONSE=1]="PEER_RESPONSE",e[e.FINAL_PEER=2]="FINAL_PEER",e[e.QUERY_ERROR=3]="QUERY_ERROR",e[e.PROVIDER=4]="PROVIDER",e[e.VALUE=5]="VALUE",e[e.ADDING_PEER=6]="ADDING_PEER",e[e.DIALING_PEER=7]="DIALING_PEER"})(Bo||(Bo={}));var Do;(function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"})(Do||(Do={}));function _o(e){return{query:xc(e)}}function bc(e){return async function(t={}){return(await e.post("diag/cmds",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()}}function Ec(e){return async function(t={}){return(await e.post("diag/net",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()}}function Sc(e){return async function(t={}){return(await e.post("diag/sys",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()}}function Ro(e){return{cmds:bc(e),net:Ec(e),sys:Sc(e)}}function Pc(e){return async function(t,n,o={}){let s=Array.isArray(t)?t:[t];await(await e.post("files/cp",{signal:o.signal,searchParams:u({arg:s.concat(n).map(a=>m.asCID(a)!=null?`/ipfs/${a}`:a),...o}),headers:o.headers})).text()}}function Ac(e){return async function(t,n={}){if(typeof t!="string")throw new Error("ipfs.files.flush requires a path");let s=await(await e.post("files/flush",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers})).json();return m.parse(s.Cid)}}function Hr(e){let r=A(e);return Object.prototype.hasOwnProperty.call(r,"mode")&&(r.mode=parseInt(r.mode,8)),Object.prototype.hasOwnProperty.call(r,"mtime")&&(r.mtime={secs:r.mtime,nsecs:r.mtimeNsecs??0},delete r.mtimeNsecs),r}function vc(e){return async function*(t,n={}){if(t==null)throw new Error("ipfs.files.ls requires a path");let o=await e.post("files/ls",{signal:n.signal,searchParams:u({arg:m.asCID(t)!=null?`/ipfs/${t}`:t,long:!0,...n,stream:!0}),headers:n.headers});for await(let s of o.ndjson())if("Entries"in s)for(let i of s.Entries??[])yield Cc(Hr(i));else yield Cc(Hr(s))}}function Cc(e){return e.hash!=null&&(e.cid=m.parse(e.hash)),delete e.hash,e.type=e.type===1?"directory":"file",e}function Ic(e){return async function(t,n={}){await(await e.post("files/mkdir",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers})).text()}}function Uc(e){return async function(t,n,o={}){Array.isArray(t)||(t=[t]),await(await e.post("files/mv",{signal:o.signal,searchParams:u({arg:t.concat(n),...o}),headers:o.headers})).text()}}function $o(e){if($m(e))return async function*(){let r=e.getReader();try{for(;;){let{done:t,value:n}=await r.read();if(t)return;yield n}}finally{r.releaseLock()}}();if(Rm(e))return e;throw new Error("unknown stream")}function Rm(e){return e[Symbol.asyncIterator]!=null}function $m(e){return typeof e?.getReader=="function"}function Tc(e){return async function*(t,n={}){let o=await e.post("files/read",{signal:n.signal,searchParams:u({arg:t,count:n.length,...n}),headers:n.headers});if(o.body==null)throw new Error("Invalid response body");yield*$o(o.body)}}var Ut=class extends Error{response;constructor(r){super(r.statusText),this.name="HTTPError",this.response=r}};function kc(e){return async function(t,n={}){let o=await e.post("files/rm",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers}),s=await o.text();if(s!==""){let i=new Ut(o);throw i.message=s,i}}}function Tt(e){return async function(t,n={}){let s=await(await e.post("files/stat",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers})).json();return s.WithLocality=s.WithLocality??!1,Lm(Hr(s))}}function Lm(e){return e.cid=m.parse(e.hash),delete e.hash,e}function Nc(e){return async function(t,n,o={}){let s=new AbortController,i=V([s.signal,o.signal]);try{await(await e.post("files/write",{signal:i,searchParams:u({arg:t,streamChannels:!0,count:o.length,...o}),...await G([{content:n,path:"arg",mode:dr(o.mode),mtime:ke(o.mtime)}],s,o.headers)})).text()}finally{i.clear()}}}function Lo(e){return{cp:Pc(e),flush:Ac(e),ls:vc(e),mkdir:Ic(e),mv:Uc(e),read:Tc(e),rm:kc(e),stat:Tt(e),write:Nc(e)}}function Bc(e){return function(){let t=new URL(e.opts.base??"");return{host:t.hostname,port:t.port,protocol:t.protocol,pathname:t.pathname,"api-path":t.pathname}}}function Dc(e){return async function*(t,n={}){let o={arg:`${t instanceof Uint8Array?m.decode(t):t}`,...n};yield*(await e.post("get",{signal:n.signal,searchParams:u(o),headers:n.headers})).iterator()}}function kt(e){return async function(t={}){let o=await(await e.post("id",{signal:t.signal,searchParams:u({arg:t.peerId!=null?t.peerId.toString():void 0,...t}),headers:t.headers})).json(),s={...A(o)};return s.id=F(s.id),s.addresses!=null&&(s.addresses=s.addresses.map(i=>k(i))),s}}function _c(e){let r=kt(e);return async function(n={}){try{return!!(await r(n))?.addresses?.length}catch{return!1}}}var Om={type:"ed25519"};function Rc(e){return async function(t,n=Om){let s=await(await e.post("key/gen",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers})).json();return A(s)}}function $c(e){return async function(t,n,o,s={}){let a=await(await e.post("key/import",{signal:s.signal,searchParams:u({arg:t,pem:n,password:o,...s}),headers:s.headers})).json();return A(a)}}function Lc(e){return async function(t={}){return((await(await e.post("key/list",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()).Keys??[]).map(s=>A(s))}}function Oc(e){return async function(t,n,o={}){let s=await e.post("key/rename",{signal:o.signal,searchParams:u({arg:[t,n],...o}),headers:o.headers});return A(await s.json())}}function Fc(e){return async function(t,n={}){let s=await(await e.post("key/rm",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers})).json();return A(s.Keys[0])}}function Oo(e){return{gen:Rc(e),import:$c(e),list:Lc(e),rename:Oc(e),rm:Fc(e)}}function Fm(e,r){try{if(typeof e=="string"&&e.length>0)return jm(e);if(typeof e=="number"&&isFinite(e))return r?.long?Mm(e):zm(e);throw new Error("Value is not a string or number.")}catch(t){let n=Vm(t)?`${t.message}. value=${JSON.stringify(e)}`:"An unknown error has occured.";throw new Error(n)}}function jm(e){if(e=String(e),e.length>100)throw new Error("Value exceeds the maximum length of 100 characters.");let r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!r)return NaN;let t=parseFloat(r[1]),n=(r[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*315576e5;case"weeks":case"week":case"w":return t*6048e5;case"days":case"day":case"d":return t*864e5;case"hours":case"hour":case"hrs":case"hr":case"h":return t*36e5;case"minutes":case"minute":case"mins":case"min":case"m":return t*6e4;case"seconds":case"second":case"secs":case"sec":case"s":return t*1e3;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:throw new Error(`The unit ${n} was matched, but no matching case exists.`)}}var Bt=Fm;function zm(e){let r=Math.abs(e);return r>=864e5?`${Math.round(e/864e5)}d`:r>=36e5?`${Math.round(e/36e5)}h`:r>=6e4?`${Math.round(e/6e4)}m`:r>=1e3?`${Math.round(e/1e3)}s`:`${e}ms`}function Mm(e){let r=Math.abs(e);return r>=864e5?Nt(e,r,864e5,"day"):r>=36e5?Nt(e,r,36e5,"hour"):r>=6e4?Nt(e,r,6e4,"minute"):r>=1e3?Nt(e,r,1e3,"second"):`${e} ms`}function Nt(e,r,t,n){let o=r>=t*1.5;return`${Math.round(e/t)} ${n}${o?"s":""}`}function Vm(e){return typeof e=="object"&&e!==null&&"message"in e}function Fo(e){t.debug=t,t.default=t,t.coerce=f,t.disable=s,t.enable=o,t.enabled=i,t.humanize=Bt,t.destroy=h,Object.keys(e).forEach(d=>{t[d]=e[d]}),t.names=[],t.skips=[],t.formatters={};function r(d){let p=0;for(let b=0;b<d.length;b++)p=(p<<5)-p+d.charCodeAt(b),p|=0;return t.colors[Math.abs(p)%t.colors.length]}t.selectColor=r;function t(d){let p,b=null,T,g;function x(...C){if(!x.enabled)return;let P=x,N=Number(new Date),_=N-(p||N);P.diff=_,P.prev=p,P.curr=N,p=N,C[0]=t.coerce(C[0]),typeof C[0]!="string"&&C.unshift("%O");let I=0;C[0]=C[0].replace(/%([a-zA-Z%])/g,(O,B)=>{if(O==="%%")return"%";I++;let $=t.formatters[B];if(typeof $=="function"){let ie=C[I];O=$.call(P,ie),C.splice(I,1),I--}return O}),t.formatArgs.call(P,C),(P.log||t.log).apply(P,C)}return x.namespace=d,x.useColors=t.useColors(),x.color=t.selectColor(d),x.extend=n,x.destroy=t.destroy,Object.defineProperty(x,"enabled",{enumerable:!0,configurable:!1,get:()=>b!==null?b:(T!==t.namespaces&&(T=t.namespaces,g=t.enabled(d)),g),set:C=>{b=C}}),typeof t.init=="function"&&t.init(x),x}function n(d,p){let b=t(this.namespace+(typeof p>"u"?":":p)+d);return b.log=this.log,b}function o(d){t.save(d),t.namespaces=d,t.names=[],t.skips=[];let p,b=(typeof d=="string"?d:"").split(/[\s,]+/),T=b.length;for(p=0;p<T;p++)b[p]&&(d=b[p].replace(/\*/g,".*?"),d[0]==="-"?t.skips.push(new RegExp("^"+d.substr(1)+"$")):t.names.push(new RegExp("^"+d+"$")))}function s(){let d=[...t.names.map(a),...t.skips.map(a).map(p=>"-"+p)].join(",");return t.enable(""),d}function i(d){if(d[d.length-1]==="*")return!0;let p,b;for(p=0,b=t.skips.length;p<b;p++)if(t.skips[p].test(d))return!1;for(p=0,b=t.names.length;p<b;p++)if(t.names[p].test(d))return!0;return!1}function a(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function f(d){return d instanceof Error?d.stack??d.message:d}function h(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.setupFormatters(t.formatters),t.enable(t.load()),t}var Dt=Xm(),Hm=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function qm(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent?.toLowerCase().match(/(edge|trident)\/(\d+)/)!=null?!1:typeof document<"u"&&document.documentElement?.style?.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent?.toLowerCase().match(/firefox\/(\d+)/)!=null&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent?.toLowerCase().match(/applewebkit\/(\d+)/)}function Gm(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+Bt(this.diff),!this.useColors)return;let r="color: "+this.color;e.splice(1,0,r,"color: inherit");let t=0,n=0;e[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(t++,o==="%c"&&(n=t))}),e.splice(n,0,r)}var Wm=console.debug??console.log??(()=>{});function Jm(e){try{e?Dt?.setItem("debug",e):Dt?.removeItem("debug")}catch{}}function Km(){let e;try{e=Dt?.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function Xm(){try{return localStorage}catch{}}function Qm(e){e.j=function(r){try{return JSON.stringify(r)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}var jc=Fo({formatArgs:Gm,save:Jm,load:Km,useColors:qm,setupFormatters:Qm,colors:Hm,storage:Dt,log:Wm});var ee=jc;ee.formatters.b=e=>e==null?"undefined":z.baseEncode(e);ee.formatters.t=e=>e==null?"undefined":ce.baseEncode(e);ee.formatters.m=e=>e==null?"undefined":qe.baseEncode(e);ee.formatters.p=e=>e==null?"undefined":e.toString();ee.formatters.c=e=>e==null?"undefined":e.toString();ee.formatters.k=e=>e==null?"undefined":e.toString();ee.formatters.a=e=>e==null?"undefined":e.toString();function Ym(e){let r=()=>{};return r.enabled=!1,r.color="",r.diff=0,r.log=()=>{},r.namespace=e,r.destroy=()=>!0,r.extend=()=>r,r}function lr(e){let r=Ym(`${e}:trace`);return ee.enabled(`${e}:trace`)&&ee.names.map(t=>t.toString()).find(t=>t.includes(":trace"))!=null&&(r=ee(`${e}:trace`)),Object.assign(ee(e),{error:ee(`${e}:error`),trace:r})}var Kc=De(Jc(),1),$t=Kc.default;var oh=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;S.nanosecond=S.ns=1/1e6;S.\u00B5s=S.\u03BCs=S.us=S.microsecond=1/1e3;S.millisecond=S.ms=S[""]=1;S.second=S.sec=S.s=S.ms*1e3;S.minute=S.min=S.m=S.s*60;S.hour=S.hr=S.h=S.m*60;S.day=S.d=S.h*24;S.week=S.wk=S.w=S.d*7;S.month=S.b=S.d*(365.25/12);S.year=S.yr=S.y=S.d*365.25;function S(e="",r="ms"){var t=null;e=(e+"").replace(/(\d)[,_](\d)/g,"$1$2");var n=e[0]==="-";return e.replace(oh,function(o,s,i){i=Xc(i),i&&(t=(t||0)+Math.abs(parseFloat(s,10))*i)}),t&&t/(Xc(r)||1)*(n?-1:1)}function Xc(e){return S[e]||S[e.toLowerCase().replace(/s$/,"")]}var Qc=S;var Yc=()=>{};var yr=De(su(),1);var hr=class extends Error{constructor(r="Request timed out"){super(r),this.name="TimeoutError"}},Lt=class extends Error{constructor(r="The operation was aborted."){super(r),this.name="AbortError"}},Gr=class extends Error{response;constructor(r){super(r.statusText),this.name="HTTPError",this.response=r}};var iu=globalThis.fetch,Wr=globalThis.Headers,Vo=globalThis.Request,Ho=globalThis.Response;var mh=async(e,r={})=>{let t=new XMLHttpRequest;t.open(r.method??"GET",e.toString(),!0);let{timeout:n,headers:o}=r,s=Number(n);if(!isNaN(s)&&s>0&&s<1/0&&(t.timeout=s),r.overrideMimeType!=null&&t.overrideMimeType(r.overrideMimeType),o!=null)for(let[i,a]of new Wr(o))t.setRequestHeader(i,a);return r.signal!=null&&(r.signal.onabort=()=>{t.abort()}),r.onUploadProgress!=null&&(t.upload.onprogress=r.onUploadProgress),t.responseType="arraybuffer",new Promise((i,a)=>{let f=h=>{switch(h.type){case"error":{i(Ho.error());break}case"load":{i(new qo(t.responseURL,t.response,{status:t.status,statusText:t.statusText,headers:yh(t.getAllResponseHeaders())}));break}case"timeout":{a(new hr);break}case"abort":{a(new Lt);break}default:break}};t.onerror=f,t.onload=f,t.ontimeout=f,t.onabort=f,t.send(r.body)})},hh=iu,au=(e,r={})=>r.onUploadProgress!=null?mh(e,r):hh(e,r),yh=e=>{let r=new Wr;for(let t of e.trim().split(/[\r\n]+/)){let n=t.indexOf(": ");n>0&&r.set(t.slice(0,n),t.slice(n+1))}return r},qo=class extends Ho{constructor(r,t,n){super(t,n),Object.defineProperty(this,"url",{value:r})}};var cu=$t.bind({ignoreUndefined:!0}),Ot=lr("kubo-rpc-client:fetch"),gh={throwHttpErrors:!0,credentials:"same-origin"},me=class e{static HTTPError=Gr;static TimeoutError=hr;static post=async(r,t)=>new e(t).post(r,t);static get=async(r,t)=>new e(t).get(r,t);static put=async(r,t)=>new e(t).put(r,t);static delete=async(r,t)=>new e(t).delete(r,t);static options=async(r,t)=>new e(t).options(r,t);opts;constructor(r={}){this.opts=cu({},gh,r)}async fetch(r,t={}){let n=cu({},this.opts,t),o=new Wr(n.headers);if(typeof r!="string"&&!(r instanceof yr.URL||r instanceof Vo))throw new TypeError("`resource` must be a string, URL, or Request");let s=new yr.URL(r.toString(),n.base),{searchParams:i,transformSearchParams:a,json:f}=n;i!=null&&(typeof a=="function"?s.search=a(new yr.URLSearchParams(n.searchParams)):s.search=new yr.URLSearchParams(n.searchParams).toString()),f!=null&&(n.body=JSON.stringify(n.json),o.set("content-type","application/json"));let h=[n.signal];n.timeout!=null&&isNaN(n.timeout)&&n.timeout>0&&h.push(AbortSignal.timeout(n.timeout));let d=V(h);try{globalThis.ReadableStream!=null&&n.body instanceof globalThis.ReadableStream&&(ur||fr)&&(n.body=new Blob(await bt(Se(n.body)))),Ot.trace("outgoing headers",n.headers),Ot.trace("%s %s",n.method,s);let p=await au(s.toString(),{...n,signal:n.signal,timeout:void 0,headers:o,duplex:"half"});if(Ot("%s %s %d",n.method,s,p.status),Ot.trace("incoming headers",p.headers),!p.ok&&n.throwHttpErrors===!0)throw n.handleError!=null&&await n.handleError(p),new Gr(p);return p.iterator=async function*(){yield*xh(p.body)},p.ndjson=async function*(){for await(let b of wh(p.iterator()))t.transform!=null?yield t.transform(b):yield b},p}finally{d.clear()}}async post(r,t={}){return this.fetch(r,{...t,method:"POST"})}async get(r,t={}){return this.fetch(r,{...t,method:"GET"})}async put(r,t={}){return this.fetch(r,{...t,method:"PUT"})}async delete(r,t={}){return this.fetch(r,{...t,method:"DELETE"})}async options(r,t={}){return this.fetch(r,{...t,method:"OPTIONS"})}},wh=async function*(e){let r=new TextDecoder,t="";for await(let n of e){t+=r.decode(n,{stream:!0});let o=t.split(/\r?\n/);for(let s=0;s<o.length-1;s++){let i=o[s].trim();i.length>0&&(yield JSON.parse(i))}t=o[o.length-1]}t+=r.decode(),t=t.trim(),t.length!==0&&(yield JSON.parse(t))},xh=e=>{if(bh(e))return e;if(Sh(e)){let r=e[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:r.next.bind(r),return(t){return e.destroy(),typeof r.return=="function"?r.return():Promise.resolve({done:!0,value:t})}}}}}if(Eh(e)){let r=e.getReader();return async function*(){try{for(;;){let{done:t,value:n}=await r.read();if(t)return;n!=null&&(yield n)}}finally{r.releaseLock()}}()}throw new TypeError("Body can't be converted to AsyncIterable")},bh=e=>e!==null&&typeof e[Symbol.asyncIterator]=="function",Eh=e=>e!=null&&typeof e.getReader=="function",Sh=e=>Object.prototype.hasOwnProperty.call(e,"readable")&&Object.prototype.hasOwnProperty.call(e,"writable");var Ph=[E("tcp").code,E("dns").code,E("dnsaddr").code,E("dns4").code,E("dns6").code];function uu(e){let r;try{r=E("sni").code}catch{return null}for(let[t,n]of e)if(t===r&&n!==void 0)return n;return null}function fu(e){return e.some(([r,t])=>r===E("tls").code)}function K(e,r,t){let n=du[E(e).name];if(n===void 0)throw new Error(`Can't interpret protocol ${E(e).name}`);let o=n(r,t);return e===E("ip6").code?`[${o}]`:o}var du={ip4:(e,r)=>e,ip6:(e,r)=>r.length===0?e:`[${e}]`,tcp:(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`tcp://${K(t[0],t[1]??"",r)}:${e}`},udp:(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`udp://${K(t[0],t[1]??"",r)}:${e}`},dnsaddr:(e,r)=>e,dns4:(e,r)=>e,dns6:(e,r)=>e,dns:(e,r)=>e,ipfs:(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`${K(t[0],t[1]??"",r)}/ipfs/${e}`},p2p:(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`${K(t[0],t[1]??"",r)}/p2p/${e}`},http:(e,r)=>{let t=fu(r),n=uu(r);if(t&&n!==null)return`https://${n}`;let o=t?"https://":"http://",s=r.pop();if(s===void 0)throw new Error("Unexpected end of multiaddr");let i=K(s[0],s[1]??"",r);return i=i.replace("tcp://",""),`${o}${i}`},"http-path":(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");let n=K(t[0],t[1]??"",r),o=decodeURIComponent(e);return`${n}/${o}`},tls:(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return K(t[0],t[1]??"",r)},sni:(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return K(t[0],t[1]??"",r)},https:(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");let n=K(t[0],t[1]??"",r);return n=n.replace("tcp://",""),`https://${n}`},ws:(e,r)=>{let t=fu(r),n=uu(r);if(t&&n!==null)return`wss://${n}`;let o=t?"wss://":"ws://",s=r.pop();if(s===void 0)throw new Error("Unexpected end of multiaddr");let i=K(s[0],s[1]??"",r);return i=i.replace("tcp://",""),`${o}${i}`},wss:(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");let n=K(t[0],t[1]??"",r);return n=n.replace("tcp://",""),`wss://${n}`},"p2p-websocket-star":(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`${K(t[0],t[1]??"",r)}/p2p-websocket-star`},"p2p-webrtc-star":(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`${K(t[0],t[1]??"",r)}/p2p-webrtc-star`},"p2p-webrtc-direct":(e,r)=>{let t=r.pop();if(t===void 0)throw new Error("Unexpected end of multiaddr");return`${K(t[0],t[1]??"",r)}/p2p-webrtc-direct`}};function lu(e,r){let n=k(e).stringTuples(),o=n.pop();if(o===void 0)throw new Error("Unexpected end of multiaddr");let s=E(o[0]),i=du[s.name];if(i==null)throw new Error(`No interpreter found for ${s.name}`);let a=i(o[1]??"",n);return r?.assumeHttp!==!1&&Ph.includes(o[0])&&(a=a.replace(/^.*:\/\//,""),o[1]==="443"?a=`https://${a}`:a=`http://${a}`),(a.startsWith("http://")||a.startsWith("https://"))&&(a=new URL(a).toString(),a.endsWith("/")&&(a=a.substring(0,a.length-1))),a}function Go(e){try{e=lu(k(e))}catch{}return e=e.toString(),e}var pu=lr("js-kubo-rpc-client:lib:error-handler"),Ah=$t.bind({ignoreUndefined:!0}),Ch=ur||fr?location.protocol:"http",vh=ur||fr?location.hostname:"localhost",Ih=ur||fr?location.port:"5001",Uh=(e={})=>{let r,t={},n;if(typeof e=="string"||Le(e))r=new URL(Go(e));else if(e instanceof URL)r=e;else if(typeof e.url=="string"||Le(e.url))r=new URL(Go(e.url)),t=e;else if(e.url instanceof URL)r=e.url,t=e;else{t=e??{};let o=(t.protocol??Ch).replace(":",""),s=(t.host??vh).split(":")[0],i=t.port??Ih;r=new URL(`${o}://${s}:${i}`)}if(t.apiPath!=null?r.pathname=t.apiPath:(r.pathname==="/"||r.pathname===void 0)&&(r.pathname="api/v0"),$a){let o=Yc(r);n=t.agent??new o({keepAlive:!0,maxSockets:6})}return{...t,host:r.host,protocol:r.protocol.replace(":",""),port:Number(r.port),apiPath:r.pathname,url:r,agent:n}},Th=async e=>{let r;try{if((e.headers.get("Content-Type")??"").startsWith("application/json")){let n=await e.json();pu(n),r=n.Message??n.message}else r=await e.text()}catch(n){pu("Failed to parse error response",n),r=n.message}let t=new me.HTTPError(e);throw r!=null&&(r.includes("deadline has elapsed")&&(t=new me.TimeoutError),r.includes("context deadline exceeded")&&(t=new me.TimeoutError),r.includes("request timed out")&&(t=new me.TimeoutError),t.message=r),t},kh=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,mu=e=>e.replace(kh,function(r){return"-"+r.toLowerCase()}),Nh=e=>typeof e=="string"?Qc(e)??0:e,Ft=class extends me{constructor(r={}){let t=Uh(r);super({timeout:t.timeout!=null?Nh(t.timeout):void 0,headers:t.headers,base:`${t.url}`,handleError:Th,transformSearchParams:o=>{let s=new URLSearchParams;for(let[i,a]of o)a!=="undefined"&&a!=="null"&&i!=="signal"&&i!=="timeout"&&s.append(mu(i),a),i==="timeout"&&!isNaN(parseInt(a))&&s.append(mu(i),a);return s},agent:t.agent}),delete this.get,delete this.put,delete this.delete,delete this.options;let n=this.fetch;this.fetch=async(o,s={})=>(typeof o=="string"&&!o.startsWith("/")&&(o=`${t.url}/${o}`),n.call(this,o,Ah(s,{method:"POST"})))}},mA=me.HTTPError;var Bh=async e=>Promise.reject(new Error(`No base found for "${e}"`)),jt=class{_basesByName;_basesByPrefix;_loadBase;constructor(r){this._basesByName={},this._basesByPrefix={},this._loadBase=r.loadBase??Bh;for(let t of r.bases)this.addBase(t)}addBase(r){if(this._basesByName[r.name]!=null&&this._basesByPrefix[r.prefix]!=null)throw new Error(`Codec already exists for codec "${r.name}"`);this._basesByName[r.name]=r,this._basesByPrefix[r.prefix]=r}removeBase(r){delete this._basesByName[r.name],delete this._basesByPrefix[r.prefix]}async getBase(r){if(this._basesByName[r]!=null)return this._basesByName[r];if(this._basesByPrefix[r]!=null)return this._basesByPrefix[r];let t=await this._loadBase(r);return this._basesByName[t.name]==null&&this._basesByPrefix[t.prefix]==null&&this.addBase(t),t}listBases(){return Object.values(this._basesByName)}};var Dh=async e=>Promise.reject(new Error(`No codec found for "${e}"`)),zt=class{_codecsByName;_codecsByCode;_loadCodec;constructor(r){this._codecsByName={},this._codecsByCode={},this._loadCodec=r.loadCodec??Dh;for(let t of r.codecs)this.addCodec(t)}addCodec(r){if(this._codecsByName[r.name]!=null||this._codecsByCode[r.code]!=null)throw new Error(`Resolver already exists for codec "${r.name}"`);this._codecsByName[r.name]=r,this._codecsByCode[r.code]=r}removeCodec(r){delete this._codecsByName[r.name],delete this._codecsByCode[r.code]}async getCodec(r){let t=typeof r=="string"?this._codecsByName:this._codecsByCode;if(t[r]!=null)return t[r];let n=await this._loadCodec(r);return t[r]==null&&this.addCodec(n),n}listCodecs(){return Object.values(this._codecsByName)}};var _h=async e=>Promise.reject(new Error(`No hasher found for "${e}"`)),Mt=class{_hashersByName;_hashersByCode;_loadHasher;constructor(r){this._hashersByName={},this._hashersByCode={},this._loadHasher=r.loadHasher??_h;for(let t of r.hashers)this.addHasher(t)}addHasher(r){if(this._hashersByName[r.name]!=null||this._hashersByCode[r.code]!=null)throw new Error(`Resolver already exists for codec "${r.name}"`);this._hashersByName[r.name]=r,this._hashersByCode[r.code]=r}removeHasher(r){delete this._hashersByName[r.name],delete this._hashersByCode[r.code]}async getHasher(r){let t=typeof r=="string"?this._hashersByName:this._hashersByCode;if(t[r]!=null)return t[r];let n=await this._loadHasher(r);return t[r]==null&&this.addHasher(n),n}listHashers(){return Object.values(this._hashersByName)}};function hu(e){return async function(r,t,n={}){let o=await e.post("log/level",{signal:n.signal,searchParams:u({arg:[r,t],...n}),headers:n.headers});return A(await o.json())}}function yu(e){return async function(t={}){return(await(await e.post("log/ls",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()).Strings}}function gu(e){return async function*(t={}){yield*(await e.post("log/tail",{signal:t.signal,searchParams:u(t),headers:t.headers})).ndjson()}}function Wo(e){return{level:hu(e),ls:yu(e),tail:gu(e)}}function wu(e){return async function*(t,n={}){let o=`${t instanceof Uint8Array?m.decode(t):t}`;async function s(a){let f=a.Hash;if(f.includes("/")===!0){let d=f.startsWith("/ipfs/")===!0?f:`/ipfs/${f}`;f=(await Tt(e)(d)).cid}else f=m.parse(f);return{name:a.Name,path:o+(a.Name!=null?`/${a.Name}`:""),size:a.Size,cid:f,type:Rh(a)}}let i=await e.post("ls",{signal:n.signal,searchParams:u({arg:o,...n}),headers:n.headers});for await(let a of i.ndjson()){if(a=a.Objects,a==null)throw new Error("expected .Objects in results");if(a=a[0],a==null)throw new Error("expected one array in results.Objects");let f=a.Links;if(!Array.isArray(f))throw new Error("expected one array in results.Objects[0].Links");if(f.length===0){yield s(a);return}yield*f.map(s)}}}function Rh(e){switch(e.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}function xu(e){return async function(t={}){let n=await e.post("dns",{signal:t.signal,searchParams:u(t),headers:t.headers});return A(await n.json())}}function bu(e){return async function(t,n={}){let o=await e.post("name/publish",{signal:n.signal,searchParams:u({arg:`${t}`,...n}),headers:n.headers});return A(await o.json())}}function Eu(e){return async function(t,n={}){let o=await e.post("name/pubsub/cancel",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers});return A(await o.json())}}function Su(e){return async function(t={}){let n=await e.post("name/pubsub/state",{signal:t.signal,searchParams:u(t),headers:t.headers});return A(await n.json())}}function Pu(e){return async function(t={}){return(await(await e.post("name/pubsub/subs",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()).Strings??[]}}function Au(e){return{cancel:Eu(e),state:Su(e),subs:Pu(e)}}function Cu(e){return async function*(t,n={}){let o=await e.post("name/resolve",{signal:n.signal,searchParams:u({arg:t,stream:!0,...n}),headers:n.headers});for await(let s of o.ndjson())yield s.Path}}function Jo(e){return{publish:bu(e),resolve:Cu(e),pubsub:Au(e)}}function vu(e){return async function(t,n,o={}){let s=await e.post("object/patch/add-link",{signal:o.signal,searchParams:u({arg:[`${t}`,n.Name??n.name??"",(n.Hash??n.cid??"").toString()??null],...o}),headers:o.headers}),{Hash:i}=await s.json();return m.parse(i)}}function Iu(e){return async function(t,n,o={}){let s=await e.post("object/patch/rm-link",{signal:o.signal,searchParams:u({arg:[`${t}`,n.Name??n.name??null],...o}),headers:o.headers}),{Hash:i}=await s.json();return m.parse(i)}}function Uu(e){return{addLink:vu(e),rmLink:Iu(e)}}function Ko(e,r){return{patch:Uu(e)}}function $h(e){return Symbol.iterator in e}function Lh(e){return Symbol.asyncIterator in e}function Tu(e){return m.asCID(e)!=null}async function*Vt(e){if(e==null)throw new oe(`Unexpected input: ${e}`,"ERR_UNEXPECTED_INPUT");let r=m.asCID(e);if(r!=null){yield J({cid:r});return}if(typeof e=="string"){yield J({path:e});return}if(e.cid!=null||e.path!=null)return yield J(e);if($h(e)){let t=e[Symbol.iterator](),n=t.next();if(n.done===!0)return t;if(Tu(n.value)){yield J({cid:n.value});for(let o of t)yield J({cid:o});return}if(typeof n.value=="string"){yield J({path:n.value});for(let o of t)yield J({path:o});return}if(n.value.cid!=null||n.value.path!=null){yield J(n.value);for(let o of t)yield J(o);return}throw new oe(`Unexpected input: ${typeof e}`,"ERR_UNEXPECTED_INPUT")}if(Lh(e)){let t=e[Symbol.asyncIterator](),n=await t.next();if(n.done===!0)return t;if(Tu(n.value)){yield J({cid:n.value});for await(let o of t)yield J({cid:o});return}if(typeof n.value=="string"){yield J({path:n.value});for await(let o of t)yield J({path:o});return}if(n.value.cid!=null||n.value.path!=null){yield J(n.value);for await(let o of t)yield J(o);return}throw new oe(`Unexpected input: ${typeof e}`,"ERR_UNEXPECTED_INPUT")}throw new oe(`Unexpected input: ${typeof e}`,"ERR_UNEXPECTED_INPUT")}function J(e){let r=e.cid??`${e.path}`;if(r==null)throw new oe("Unexpected input: Please path either a CID or an IPFS path","ERR_UNEXPECTED_INPUT");let t={path:r,recursive:e.recursive!==!1};return e.metadata!=null&&(t.metadata=e.metadata),t}function Ht(e){return async function*(t,n={}){for await(let{path:o,recursive:s,metadata:i}of Vt(t)){let a=await e.post("pin/add",{signal:n.signal,searchParams:u({...n,arg:o,recursive:s,metadata:i!=null?JSON.stringify(i):void 0,stream:!0}),headers:n.headers});for await(let f of a.ndjson()){if(f.Pins!=null){for(let h of f.Pins)yield m.parse(h);continue}yield m.parse(f)}}}}function ku(e){let r=Ht(e);return async function(n,o={}){let s=await Ne(r([{path:n.toString(),...o}],o));if(s==null)throw new Error("No response received");return s}}function Nu(e,r,t){let n={type:e,cid:m.parse(r)};return t!=null&&(n.metadata=t),n}function Bu(e){return async function*(t={}){let n=[];t.paths!=null&&(n=Array.isArray(t.paths)?t.paths:[t.paths]);let o=await e.post("pin/ls",{signal:t.signal,searchParams:u({...t,arg:n.map(s=>`${s}`),stream:!0}),headers:t.headers});for await(let s of o.ndjson()){if(s.Keys!=null){for(let i of Object.keys(s.Keys))yield Nu(s.Keys[i].Type,i,s.Keys[i].Metadata);return}yield Nu(s.Type,s.Cid,s.Metadata)}}}var qt=({Name:e,Status:r,Cid:t})=>({cid:m.parse(t),name:e,status:r}),Du=e=>{if(typeof e=="string"&&e!=="")return e;throw new TypeError("service name must be passed")},_u=e=>{if(m.asCID(e)!=null)return e.toString();throw new TypeError(`CID instance expected instead of ${typeof e}`)},gr=({service:e,cid:r,name:t,status:n,all:o})=>{let s=u({service:Du(e),name:t,force:o===!0?!0:void 0});if(r!=null)for(let i of r)s.append("cid",_u(i));if(n!=null)for(let i of n)s.append("status",i);return s},Ru=(e,{service:r,background:t,name:n,origins:o})=>{let s=u({arg:_u(e),service:Du(r),name:n,background:t===!0?!0:void 0});if(o!=null)for(let i of o)s.append("origin",i.toString());return s};function $u(e){return async function(t,{timeout:n,signal:o,headers:s,...i}){let a=await e.post("pin/remote/add",{timeout:n,signal:o,headers:s,searchParams:Ru(t,i)});return qt(await a.json())}}function Lu(e){return async function*({timeout:t,signal:n,headers:o,...s}){let i=await e.post("pin/remote/ls",{timeout:t,signal:n,headers:o,searchParams:gr(s)});for await(let a of i.ndjson())yield qt(a)}}function Ou(e){return async function({timeout:t,signal:n,headers:o,...s}){await e.post("pin/remote/rm",{timeout:t,signal:n,headers:o,searchParams:gr({...s,all:!0})})}}function Fu(e){return async function({timeout:t,signal:n,headers:o,...s}){await e.post("pin/remote/rm",{timeout:t,signal:n,headers:o,searchParams:gr({...s,all:!1})})}}function ju(e){let r=String(e);if(r==="undefined")throw Error("endpoint is required");return r[r.length-1]==="/"?r.slice(0,-1):r}function zu(e){let r={service:e.Service,endpoint:new URL(e.ApiEndpoint)};return e.Stat!=null&&(r.stat=Oh(e.Stat)),r}function Oh(e){switch(e.Status){case"valid":{let{Pinning:r,Pinned:t,Queued:n,Failed:o}=e.PinCount;return{status:"valid",pinCount:{queued:n,pinning:r,pinned:t,failed:o}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}function Mu(e){return async function(t,n){let{endpoint:o,key:s,headers:i,timeout:a,signal:f}=n;await e.post("pin/remote/service/add",{timeout:a,signal:f,searchParams:u({arg:[t,ju(o),s]}),headers:i})}}function Vu(e){return async function(t={}){let{stat:n,headers:o,timeout:s,signal:i}=t;return(await(await e.post("pin/remote/service/ls",{timeout:s,signal:i,headers:o,searchParams:n===!0?u({stat:n}):void 0})).json()).RemoteServices.map(zu)}}function Hu(e){return async function(t,n={}){await e.post("pin/remote/service/rm",{signal:n.signal,headers:n.headers,searchParams:u({arg:t})})}}function qu(e){return{add:Mu(e),ls:Vu(e),rm:Hu(e)}}function Gu(e){return{add:$u(e),ls:Lu(e),rm:Fu(e),rmAll:Ou(e),service:qu(e)}}function Gt(e){return async function*(t,n={}){for await(let{path:o,recursive:s}of Vt(t)){let i=new URLSearchParams(n.searchParams);i.append("arg",`${o}`),s!=null&&i.set("recursive",String(s));let a=await e.post("pin/rm",{signal:n.signal,headers:n.headers,searchParams:u({...n,arg:`${o}`,recursive:s})});for await(let f of a.ndjson()){if(f.Pins!=null){yield*f.Pins.map(h=>m.parse(h));continue}yield m.parse(f)}}}}function Wu(e){let r=Gt(e);return async function(n,o={}){let s=await Ne(r([{path:n.toString(),...o}],o));if(s==null)throw new Error("No response received");return s}}function Xo(e){return{addAll:Ht(e),add:ku(e),ls:Bu(e),rmAll:Gt(e),rm:Wu(e),remote:Gu(e)}}function Ju(e){return async function*(t,n={}){yield*(await e.post("ping",{signal:n.signal,searchParams:u({arg:`${t}`,...n}),headers:n.headers,transform:A})).ndjson()}}var Ku=e=>Array.isArray(e)?e.map(Wt):e,Wt=e=>D(wr(e)),wr=e=>Ar.decode(e),Xu=e=>BigInt(`0x${D(Ar.decode(e),"base16")}`),xr=e=>Ar.encode(ue(e));function Qu(e){return async function(t={}){let{Strings:n}=await(await e.post("pubsub/ls",{signal:t.signal,searchParams:u(t),headers:t.headers})).json();return Ku(n)??[]}}function Yu(e){return async function(t,n={}){let o=await e.post("pubsub/peers",{signal:n.signal,searchParams:u({arg:xr(t),...n}),headers:n.headers}),{Strings:s}=await o.json();return s??[]}}function Zu(e){return async function(t,n,o={}){let s=u({arg:xr(t),...o}),i=new AbortController,a=V([i.signal,o.signal]);try{await(await e.post("pubsub/pub",{signal:a,searchParams:s,...await G([n],i,o.headers)})).text()}finally{a.clear()}}}var Fh=lr("js-kubo-rpc-client:pubsub:subscribe");function ef(e,r){return async function(n,o,s={}){s.signal=r.subscribe(n,o,s.signal);let i,a,f=new Promise((d,p)=>{i=d,a=p}),h=setTimeout(()=>{i()},1e3);return e.post("pubsub/sub",{signal:s.signal,searchParams:u({arg:xr(n),...s}),headers:s.headers}).catch(d=>{r.unsubscribe(n,o),a(d)}).then(d=>{clearTimeout(h),d!=null&&(jh(d,{onMessage:p=>{if(o!=null){if(typeof o=="function"){o(p);return}typeof o.handleEvent=="function"&&o.handleEvent(p)}},onEnd:()=>{r.unsubscribe(n,o)},onError:s.onError}),i())}),f}}async function jh(e,{onMessage:r,onEnd:t,onError:n}){n=n??Fh;try{for await(let o of e.ndjson())try{if(o.from==null)continue;o.from!=null&&o.seqno!=null?r({type:"signed",from:F(o.from),data:wr(o.data),sequenceNumber:Xu(o.seqno),topic:Wt(o.topicIDs[0]),key:wr(o.key??"u"),signature:wr(o.signature??"u")}):r({type:"unsigned",data:wr(o.data),topic:Wt(o.topicIDs[0])})}catch(s){s.message=`Failed to parse pubsub message: ${s.message}`,n(s,!1,o)}}catch(o){zh(o)||n(o,!0)}finally{t()}}var zh=e=>{switch(e.type){case"aborted":return!0;case"abort":return!0;default:return e.name==="AbortError"}};var Jt=class{_subs;constructor(){this._subs=new Map}subscribe(r,t,n){let o=this._subs.get(r)??[];if(o.find(i=>i.handler===t)!=null)throw new Error(`Already subscribed to ${r} with this handler`);let s=new AbortController;return this._subs.set(r,[{handler:t,controller:s}].concat(o)),n?.addEventListener("abort",()=>{this.unsubscribe(r,t)}),s.signal}unsubscribe(r,t){let n=this._subs.get(r)??[],o;t!=null?(this._subs.set(r,n.filter(s=>s.handler!==t)),o=n.filter(s=>s.handler===t)):(this._subs.set(r,[]),o=n),(this._subs.get(r)??[]).length===0&&this._subs.delete(r),o.forEach(s=>{s.controller.abort()})}};function rf(e,r){return async function(n,o){r.unsubscribe(n,o)}}function Qo(e){let r=new Jt;return{ls:Qu(e),peers:Yu(e),publish:Zu(e),subscribe:ef(e,r),unsubscribe:rf(e,r)}}function tf(e){return async function*(t={}){yield*(await e.post("refs/local",{signal:t.signal,transform:A,searchParams:u(t),headers:t.headers})).ndjson()}}function Yo(e){async function*r(t,n={}){let o=Array.isArray(t)?t:[t];yield*(await e.post("refs",{signal:n.signal,searchParams:u({arg:o.map(i=>`${i instanceof Uint8Array?m.decode(i):i}`),...n}),headers:n.headers,transform:A})).ndjson()}return Object.assign(r,{local:tf(e)})}function nf(e){return async function*(t={}){yield*(await e.post("repo/gc",{signal:t.signal,searchParams:u(t),headers:t.headers,transform:o=>({err:o.Error!=null?new Error(o.Error):null,cid:o.Key?.["/"]!=null?m.parse(o.Key["/"]):null})})).ndjson()}}function Kt(e){return async function(t={}){let o=await(await e.post("repo/stat",{signal:t.signal,searchParams:u(t),headers:t.headers})).json();return{numObjects:BigInt(o.NumObjects),repoSize:BigInt(o.RepoSize),repoPath:o.RepoPath,version:o.Version,storageMax:BigInt(o.StorageMax)}}}function of(e){return async function(t={}){return(await(await e.post("repo/version",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()).Version}}function Zo(e){return{gc:nf(e),stat:Kt(e),version:of(e)}}function sf(e){return async function(t,n={}){let o=await e.post("resolve",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers}),{Path:s}=await o.json();return s}}function af(e){return async function*(t,n={}){let o=await e.post("routing/findpeer",{signal:n.signal,searchParams:u({arg:t.toString(),stream:!0,...n}),headers:n.headers});for await(let s of o.ndjson())yield se(s)}}function cf(e){return async function*(t,n={}){let o=await e.post("routing/findprovs",{signal:n.signal,searchParams:u({arg:t.toString(),...n}),headers:n.headers});for await(let s of o.ndjson())yield se(s)}}function uf(e){return async function*(t,n={}){let o=await e.post("routing/get",{signal:n.signal,searchParams:u({arg:t instanceof Uint8Array?D(t):t.toString(),...n}),headers:n.headers});for await(let s of o.ndjson())yield se(s)}}function ff(e){return async function*(t,n={recursive:!1}){let o=Array.isArray(t)?t:[t],s=await e.post("routing/provide",{signal:n.signal,searchParams:u({arg:o.map(i=>i.toString()),...n}),headers:n.headers});for await(let i of s.ndjson())yield se(i)}}function df(e){return async function*(t,n,o={}){let s=new AbortController,i=V([s.signal,o.signal]);try{let a=await e.post("routing/put",{signal:i,searchParams:u({arg:t instanceof Uint8Array?D(t):t.toString(),stream:!0,...o}),...await G([n],s,o.headers)});for await(let f of a.ndjson())yield se(f)}finally{i.clear()}}}function es(e){return{findPeer:af(e),findProvs:cf(e),get:uf(e),provide:ff(e),put:df(e)}}function lf(e){return async function*(t={}){yield*(await e.post("stats/bw",{signal:t.signal,searchParams:u(t),headers:t.headers,transform:o=>({totalIn:BigInt(o.TotalIn),totalOut:BigInt(o.TotalOut),rateIn:parseFloat(o.RateIn),rateOut:parseFloat(o.RateOut)})})).ndjson()}}function rs(e){return{bitswap:vt(e),repo:Kt(e),bw:lf(e)}}function pf(e){return async function(t={}){await(await e.post("shutdown",{signal:t.signal,searchParams:u(t),headers:t.headers})).text()}}function mf(e){return async function(t={}){let n=await e.post("swarm/addrs",{signal:t.signal,searchParams:u(t),headers:t.headers}),{Addrs:o}=await n.json();return Object.keys(o).map(s=>({id:F(s),addrs:(o[s]??[]).map(i=>k(i))}))}}function hf(e){return async function(t,n={}){let o=await e.post("swarm/connect",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers}),{Strings:s}=await o.json();return s??[]}}function yf(e){return async function(t,n={}){let o=await e.post("swarm/disconnect",{signal:n.signal,searchParams:u({arg:t,...n}),headers:n.headers}),{Strings:s}=await o.json();return s??[]}}function gf(e){return async function(t={}){let n=await e.post("swarm/addrs/local",{signal:t.signal,searchParams:u(t),headers:t.headers}),{Strings:o}=await n.json();return(o??[]).map(s=>k(s))}}function wf(e){return async function(t={}){return((await(await e.post("swarm/peers",{signal:t.signal,searchParams:u(t),headers:t.headers})).json()).Peers??[]).map(s=>({addr:k(s.Addr),peer:F(s.Peer),muxer:s.Muxer,latency:s.Latency,streams:s.Streams,direction:s.Direction==null?void 0:s.Direction===0?"inbound":"outbound"}))}}function ts(e){return{addrs:mf(e),connect:hf(e),disconnect:yf(e),localAddrs:gf(e),peers:wf(e)}}function xf(e){return async function(t={}){let n=await e.post("version",{signal:t.signal,searchParams:u(t),headers:t.headers});return{...A(await n.json()),"ipfs-http-client":"1.0.0"}}}var ns=class{bases;codecs;hashers;bitswap;block;bootstrap;config;dag;dht;diag;files;key;log;name;object;pin;pubsub;refs;repo;routing;stats;swarm;add;addAll;cat;get;ls;id;version;stop;ping;resolve;commands;mount;isOnline;getEndpointConfig;constructor(r){let t=new Ft(r),n={name:ve.name,code:ve.code,encode:a=>a,decode:a=>a},o=Object.values(he);(r.ipld?.bases??[]).forEach(a=>o.push(a)),this.bases=new jt({bases:o,loadBase:r.ipld?.loadBase});let s=Object.values(As);[ao,yt,to,wo,n].concat(r.ipld?.codecs??[]).forEach(a=>{s.push(a)}),this.codecs=new zt({codecs:s,loadCodec:r.ipld?.loadCodec});let i=Object.values(Ps);(r.ipld?.hashers??[]).forEach(a=>i.push(a)),this.hashers=new Mt({hashers:i,loadHasher:r.ipld?.loadHasher}),this.bitswap=Co(t),this.block=vo(t),this.bootstrap=Io(t),this.config=Uo(t),this.dag=No(t,this.codecs),this.dht=_o(t),this.diag=Ro(t),this.files=Lo(t),this.key=Oo(t),this.log=Wo(t),this.name=Jo(t),this.object=Ko(t,this.codecs),this.pin=Xo(t),this.pubsub=Qo(t),this.refs=Yo(t),this.repo=Zo(t),this.routing=es(t),this.stats=rs(t),this.swarm=ts(t),this.add=Ha(t),this.addAll=Pt(t),this.cat=oc(t),this.get=Dc(t),this.ls=wu(t),this.id=kt(t),this.version=xf(t),this.stop=pf(t),this.ping=Ju(t),this.resolve=sf(t),this.commands=sc(t),this.mount=xu(t),this.isOnline=_c(t),this.getEndpointConfig=Bc(t)}};function bf(e){return new ns(e)}function Mh(e={}){return(typeof e=="string"||Le(e)||e instanceof URL)&&(e={url:e}),bf(e)}function Vh(e,r){return{path:decodeURIComponent(new URL(e).pathname.split("/").pop()??""),content:Ef(e,r)}}async function*Ef(e,r){yield*(await me.get(e,r)).iterator()}return If(Hh);})();
return KuboRpcClient}));
